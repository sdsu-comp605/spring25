
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>7) CPU Optimization: Matrix-Matrix Multiply &#8212; Scientific Computing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/module2-2_cpu_optimization';</script>
    <link rel="icon" href="../_static/SDSU-comp605_logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8) Blocked Matrix-Matrix Multiplication" href="module2-3_blocked_mmm.html" />
    <link rel="prev" title="6) Measuring Performance" href="module2-1_measuring_performance.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-light" alt="Scientific Computing - Home"/>
    <script>document.write(`<img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-dark" alt="Scientific Computing - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../lectures.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module1-1_first_class.html">1) First Class: Reproducibility and Git</a></li>


<li class="toctree-l2"><a class="reference internal" href="module1-2_linux.html">2) The Linux Filesystem and commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-3_community_projects.html">3) Community Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-4_intro_architectures.html">4) Introduction to Computer Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-5_intro_vectorization.html">5) Introduction to Vectorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-1_measuring_performance.html">6) Measuring Performance</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">7) CPU Optimization: Matrix-Matrix Multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-3_blocked_mmm.html">8) Blocked Matrix-Matrix Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-4_packing_for_cache.html">9) Packing for cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-5_intro_multithreading.html">10) Introduction to Multithreading</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-1_intro_parallel_scaling.html">11) Introduction to Parallel Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-2_intro_to_openmp.html">12) Introduction to OpenMP</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-3_openmp_tasks.html">13) More on OpenMP and OpenMP Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-1_case_study_1_libceed.html">14) Case Study 1: libCEED</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-2_case_study_2_climacore.html">15) Case Study 2: ClimaCore</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-1_reductions_and_scans.html">16) Parallel reductions and scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-2_intro_to_mpi.html">17) Introduction to MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-3_intro_to_slurm.html">18) Introduction to Batch Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-4_parallel_linear_alegebra.html">19) Parallel Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="module6-1_intro_to_mpi_jl.html">20) Introduction to MPI.jl</a></li>
<li class="toctree-l2"><a class="reference internal" href="module6-2_blocking_vs_nonblocking.html">21) Blocking and non-blocking communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="module6-3_collectives.html">22) Collective communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="module7-1_coprocessors.html">23) Coprocessor architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="module7-2_cuda.html">24) GPUs and CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="module7-3_practical_cuda.html">25) Practical CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="module8-1_cuda_jl.html">26) Intro to GPU programming in Julia</a></li>
<li class="toctree-l2"><a class="reference internal" href="module8-2_cuda_jl_memory.html">27) Memory management with CUDA.jl</a></li>
<li class="toctree-l2"><a class="reference internal" href="module8-3_cuda_jl_reduction.html">28) Parallel reductions with CUDA.jl</a></li>
<li class="toctree-l2"><a class="reference internal" href="module9-1_ispc_and_others.html">29) ISPC, OpenMP target, OpenACC, and all that</a></li>
<li class="toctree-l2"><a class="reference internal" href="module9-2_parallel_io.html">30) I/O in HPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="module10-1_careers.html">31) Careers in HPSC</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25/issues/new?title=Issue%20on%20page%20%2Flectures/module2-2_cpu_optimization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/module2-2_cpu_optimization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>7) CPU Optimization: Matrix-Matrix Multiply</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-cpu-optimization">1. Introduction to CPU Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-matrix-multiply">1.1 Matrix-Matrix Multiply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering">2. Loop ordering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ijp">2.1 Loop ordering: ijp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ipj">2.2 Loop ordering: ipj</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pij">2.3 Loop ordering: pij</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pji">2.4 Loop ordering: pji</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jpi">2.5 Loop ordering: jpi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jip">2.6 Loop ordering: jip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-and-observations">Questions and observations:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cpu-optimization-matrix-matrix-multiply">
<h1>7) CPU Optimization: Matrix-Matrix Multiply<a class="headerlink" href="#cpu-optimization-matrix-matrix-multiply" title="Link to this heading">#</a></h1>
<p>Last time:</p>
<ul class="simple">
<li><p>Measuring performance</p></li>
</ul>
<p>Today:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#introduction-to-cpu-optimization"><span class="xref myst">Introduction to CPU Optimization</span></a><br />
1.1 <a class="reference internal" href="#matrix-matrix-multiply"><span class="xref myst">Matrix-Matrix Multiply</span></a></p></li>
<li><p><a class="reference internal" href="#loop-ordering"><span class="xref myst">Loop ordering</span></a></p></li>
</ol>
<section id="introduction-to-cpu-optimization">
<h2>1. Introduction to CPU Optimization<a class="headerlink" href="#introduction-to-cpu-optimization" title="Link to this heading">#</a></h2>
<p>In this module we talk about optimizing matrix-matrix multiply on the CPU. Some of the material here is largely based on the <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/LAFF-On-PfHP.html">LAFF-On Programming for High Performance</a> of Robert van de Geijn,
Margaret Myers, Devangi Parikh, which has a pairing online MOOC: <a class="reference external" href="https://www.cs.utexas.edu/users/flame/laff/pfhp/LAFF-On-PfHP.html">LAFF-On Programming for High Performance (LAFF-On-PfHP)</a>.</p>
<p>I encourage you to watch the videos before class. When watching the videos, really you should be watching for the <em>big picture</em> and we will revisit most of the material in lecture as well, mainly you will have a better learning experience if the in class lectures are the first time you’ve seen some of the material.</p>
<p>The MOOC is done using C (not Julia), so some of the syntax and language discussion is not relevant, but the overall ideas apply.</p>
<p>Two big differences between the material presented in C Vs Julia:</p>
<ol class="arabic simple">
<li><p>Julia starts it’s indexing with <code class="docutils literal notranslate"><span class="pre">1</span></code> whereas C uses <code class="docutils literal notranslate"><span class="pre">0</span></code>, so the first element of an array <code class="docutils literal notranslate"><span class="pre">A</span></code> in Julia is:</p></li>
</ol>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>whereas in C is:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The second difference is that in C, matrices are not
really first-class objects so they must be indexed as flat vectors. In Julia, even though behind the scenes everything is a flat vector, we can index into matrices directly.</p></li>
</ol>
<p>Some additional Julia related material was gleaned from Sacha Verweij’s repository <a class="reference external" href="https://github.com/Sacha0/GemmDemo.jl">GemmDemo.jl</a> and from a former colleague, Maciej Waruszewski’s repository <a class="reference external" href="https://github.com/mwarusz/MyJuliaGEMM">MyJuliaGEMM</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Gemm in the name of the routine stands for <strong>General Matrix-Matrix multiplication</strong>. Gemm is an acronym that is widely used in scientific computing, with roots in the Basic Linear Algebra Subprograms (BLAS).</p>
</div>
<p>Why do we care about CPU optimization (and not just MPI). Again, because of this:</p>
<p><img alt="42 years of microprocessor data" src="https://www.karlrupp.net/wp-content/uploads/2018/02/42-years-processor-trend.png" /></p>
<p>Source: <a class="reference external" href="https://github.com/karlrupp/microprocessor-trend-data">Microprocessor Trend Data</a>.</p>
<blockquote>
<div><p>Related videos and texts:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=knTLy1j-rco">1.1.1 Launch, part 1</a> (time 7:51), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-launch.html">text</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=cRyVMrNNRCk">GFLOPS</a> (time: 5:31), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-launch.html">text</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=PhjildK5oO8">1.2.2  The leading dimension of a matrix</a>
(time: 4:02), <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-the-leading-dimension.html">text</a>.</p></li>
</ul>
</div></blockquote>
<section id="matrix-matrix-multiply">
<h3>1.1 Matrix-Matrix Multiply<a class="headerlink" href="#matrix-matrix-multiply" title="Link to this heading">#</a></h3>
<p>We will focus on matrix-matrix multiplication:</p>
<div class="math notranslate nohighlight">
\[
C = C + A * B
\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is <span class="math notranslate nohighlight">\(m \times n\)</span>, <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(m \times k\)</span>, and <span class="math notranslate nohighlight">\(B\)</span> is <span class="math notranslate nohighlight">\(k \times n\)</span>.</p>
<p>The formula we learn for this in Linear Algebra is the following:</p>
<div class="math notranslate nohighlight">
\[
γ_{ij} = γ_{ij} + \sum_{p=1}^{k} α_{ip} β_{pj}
\]</div>
<p>where <span class="math notranslate nohighlight">\(γ_{ij}\)</span>, <span class="math notranslate nohighlight">\(α_{ip}\)</span>, and <span class="math notranslate nohighlight">\(β_{pj}\)</span> are the elements of the matrices <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(A\)</span>, and <span class="math notranslate nohighlight">\(B\)</span>, respectively.</p>
<section id="notation">
<h4>Notation<a class="headerlink" href="#notation" title="Link to this heading">#</a></h4>
<p>See <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-notation.html">text 1.3.1 Notation</a>.</p>
<ul class="simple">
<li><p>Capital letters for matrices <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, etc.</p></li>
<li><p>lower case letters for vectors <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, etc.</p></li>
<li><p>lower case Greek letters for floating point scalars
<span class="math notranslate nohighlight">\(α\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(A\)</span>),
<span class="math notranslate nohighlight">\(β\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(B\)</span>),
<span class="math notranslate nohighlight">\(γ\)</span> (corresponds to matrix <span class="math notranslate nohighlight">\(C\)</span>),</p></li>
<li><p>lower case letters for integer scalars <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(k\)</span> (for matrix sizes) and <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(p\)</span> for element indices</p></li>
<li><p>Often useful to think of matrices as collections of column and/or row vectors:</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(m \times k\)</span> matrix, then we expose its columns as</p>
<div class="math notranslate nohighlight">
\[
 A = [a_1 | a_2 | \dots | a_k] 
\]</div>
<p>so that <span class="math notranslate nohighlight">\(a_j\)</span> equals the column with index <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>We can expose its rows as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A =
   \begin{bmatrix}
     \tilde{a}_{1}^{T}\\
     \tilde{a}_{2}^{T}\\
     \ddots\\
     \tilde{a}_{m}^{T}
   \end{bmatrix}
\end{split}\]</div>
<p>so that <span class="math notranslate nohighlight">\(\tilde{a}_{i}\)</span> equals the row at index <span class="math notranslate nohighlight">\(i\)</span>. Here the <span class="math notranslate nohighlight">\(^T\)</span> indicates it is a row (a column vector that has been transposed). The tilde is added for clarity since <span class="math notranslate nohighlight">\(a^T_i\)</span>  would in this setting equal the column indexed with <span class="math notranslate nohighlight">\(i\)</span> that has been transposed, rather than the row indexed with <span class="math notranslate nohighlight">\(i\)</span> or any subset of the vector. When there isn’t a cause for confusion, we will sometimes leave the tilde off.</p>
<ul class="simple">
<li><p>Note that we think of all vectors as column vectors by default.</p></li>
</ul>
</section>
</section>
</section>
<section id="loop-ordering">
<h2>2. Loop ordering<a class="headerlink" href="#loop-ordering" title="Link to this heading">#</a></h2>
<p>See <a class="reference external" href="https://www.cs.utexas.edu/~flame/laff/pfhp/week1-ordering-the-loops.html">text 1.2.4 Ordering the loops</a>.</p>
<p>When the above formula is implemented as a triply nested loop:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
</pre></div>
</div>
<p>The loop ordering does not impact the correctness of the algorithm. Each of the loop orderings can be interpreted slightly differently.</p>
<p>In the example above, we call “ijp” the loop ordering, since the loop index variables appear from outer most loop to inner most loop this way.</p>
<section id="loop-ordering-ijp">
<h3>2.1 Loop ordering: ijp<a class="headerlink" href="#loop-ordering-ijp" title="Link to this heading">#</a></h3>
<p>Row vectors of <span class="math notranslate nohighlight">\(A\)</span> times the matrix <span class="math notranslate nohighlight">\(B\)</span> (update rows of <span class="math notranslate nohighlight">\(C\)</span>):</p>
<div class="math notranslate nohighlight">
\[
  \tilde{c}_{i}^T = \tilde{c}_{i}^{T} + \tilde{a}_{i}^T B
\]</div>
<p>with inner <span class="math notranslate nohighlight">\(\tilde{a}_{i}^T B\)</span> computed using dot products (update <span class="math notranslate nohighlight">\(\gamma_{ij}\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \tilde{a}_{i}^T B =
   \begin{bmatrix}
     \tilde{a}_{i}^T b_1 &amp; \cdots &amp; \tilde{a}_{i}^T b_m
   \end{bmatrix}
\]</div>
<p><img alt="ijp loop ordering" src="../_images/ijp.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Row vectors of A times the matrix B (update rows of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ijp!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_ijp! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong>:</p>
<p>In the code above (and codes below) we have used the <code class="docutils literal notranslate"><span class="pre">&#64;inbounds</span></code> macro in Julia. This tells the compiler to avoid <a class="reference external" href="https://docs.julialang.org/en/v1/devdocs/boundscheck/">bounds checking</a> that would normally be applied to ensure program safety when accessing arrays. Use this to improve runtime performance <em>only if</em> you are extremely confident that your code might not try to access/read/write out of bounds data.</p>
</section>
<section id="loop-ordering-ipj">
<h3>2.2 Loop ordering: ipj<a class="headerlink" href="#loop-ordering-ipj" title="Link to this heading">#</a></h3>
<p>Row vectors of <span class="math notranslate nohighlight">\(A\)</span> times the matrix <span class="math notranslate nohighlight">\(B\)</span> (update rows of <span class="math notranslate nohighlight">\(C\)</span>):</p>
<div class="math notranslate nohighlight">
\[
  \tilde{c}_{i}^T = \tilde{c}_{i}^{T} + \tilde{a}_{i}^T B
\]</div>
<p>but this time with inner product <span class="math notranslate nohighlight">\(\tilde{a}_{i}^T B\)</span> computed using <a class="reference external" href="https://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms"><code class="docutils literal notranslate"><span class="pre">axpy</span></code></a>, scalar times vector plus vector (update rows of C, <span class="math notranslate nohighlight">\(\tilde{c}_{i}^T\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \tilde{a}_{i}^T B = \sum_{p=1}^{k} \alpha_{ip} \tilde{b}_p^T
\]</div>
<p><img alt="ipj loop ordering" src="../_images/ipj.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Row vectors of A times the matrix B (update rows of `C`) with inner `axpy`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ipj!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>


<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_ipj! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-pij">
<h3>2.3 Loop ordering: pij<a class="headerlink" href="#loop-ordering-pij" title="Link to this heading">#</a></h3>
<p>Rank one update (repeatedly update all elements of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  C = C + \sum_{p=1}^{k} a_{p} \tilde{b}_{p}^T
\]</div>
<p>with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with vector <span class="math notranslate nohighlight">\(\tilde{b}_{p}^{T}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    \alpha_{1p} \tilde{b}_{p}^T\\
    \vdots\\
    \alpha_{np} \tilde{b}_{p}^T
  \end{bmatrix}
\end{split}\]</div>
<p><img alt="pij loop ordering" src="../_images/pij.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using `axpy` with rows of `B`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pij!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_pij! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-pji">
<h3>2.4 Loop ordering: pji<a class="headerlink" href="#loop-ordering-pji" title="Link to this heading">#</a></h3>
<p>Rank one update (repeatedly update all elements of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  C = C + \sum_{p=1}^{k} a_{p} \tilde{b}_{p}^T
\]</div>
<p>with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with column vector <span class="math notranslate nohighlight">\(a_{p}\)</span></p>
<div class="math notranslate nohighlight">
\[
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    a_{p} \beta_{p1} &amp; \cdots &amp; a_{p} \beta_{pm}
  \end{bmatrix}
\]</div>
<p><img alt="pji loop ordering" src="../_images/pji.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using `axpy` with columns of `A`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pji!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_pji! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-jpi">
<h3>2.5 Loop ordering: jpi<a class="headerlink" href="#loop-ordering-jpi" title="Link to this heading">#</a></h3>
<p>Matrix times column vector (update columns of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  c_j = c_{j} + A b_j
\]</div>
<p>with inner products <span class="math notranslate nohighlight">\(A b_j\)</span> computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code>:</p>
<div class="math notranslate nohighlight">
\[
  A b_j = \sum_{p=1}^{k} a_{p}\beta_{pj}
\]</div>
<p><img alt="jpi loop ordering" src="../_images/jpi.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times column vector (update columns of `C`) with inner `axpy`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jpi!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jpi! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loop-ordering-jip">
<h3>2.6 Loop ordering: jip<a class="headerlink" href="#loop-ordering-jip" title="Link to this heading">#</a></h3>
<p>Matrix times column vector (update columns of <span class="math notranslate nohighlight">\(C\)</span>)</p>
<div class="math notranslate nohighlight">
\[
  c_j = c_{j} + A b_j
\]</div>
<p>with inner products <span class="math notranslate nohighlight">\(A b_j\)</span> computed using dot products</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  A b_j =
  \begin{bmatrix}
    \tilde{a}_{1}^{T} b_{j}\\
    \vdots\\
    \tilde{a}_{n}^{T} b_{j}\\
  \end{bmatrix}
\end{split}\]</div>
<p><img alt="jip loop ordering" src="../_images/jip.png" /></p>
<p>Example in Julia:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jip!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jip! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h3>
<p>We now want to test all these different implementations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># What modules / packages do we depend on</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Printf</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="n">default</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c"># Plots embelishments</span>

<span class="c"># To ensure repeatability</span>
<span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">777</span><span class="p">)</span>

<span class="c"># Don&#39;t let BLAS use lots of threads (since we are not multi-threaded yet!)</span>
<span class="n">BLAS</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># C := α * A * B + β * C</span>
<span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mul!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span>

<span class="c"># Algo 2.1: matrix times row vector (update rows of `C`) with inner dot product</span>
<span class="n">mygemm!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mygemm_ijp!</span>

<span class="c"># Algo 2.2: matrix times row vector (update rows of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_ipj!</span>

<span class="c"># Algo 2.3: Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with rows of `B`</span>
<span class="c"># mygemm! = mygemm_pij!</span>

<span class="c"># Algo 2.4: Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with columns of `A`</span>
<span class="c"># mygemm! = mygemm_pji!</span>

<span class="c"># Algo 2.5: matrix times column vector (update columns of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_jpi!</span>

<span class="c"># Algo 2.6: matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="c"># mygemm! = mygemm_jip!</span>

<span class="n">num_reps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="c"># What precision numbers to use</span>
<span class="c"># FloatType = Float32</span>
<span class="n">FloatType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span>

<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;size |      reference      |           </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">)</span>
<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;     |   seconds   GFLOPS  |   seconds   GFLOPS     err</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">480</span>
<span class="n">best_perf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="c"># Size of square matrix to consider</span>
<span class="k">for</span><span class="w"> </span><span class="n">nmk</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">N</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Int</span><span class="p">(</span><span class="n">nmk</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nmk</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%4d</span><span class="s"> |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nmk</span><span class="p">)</span>

<span class="w">  </span><span class="n">gflops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-09</span>

<span class="w">  </span><span class="c"># Create the A, B, and C matrices with some random data</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Make a copy of C for resetting data later</span>
<span class="w">  </span><span class="n">C_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="w">  </span><span class="c"># The &quot;truth&quot;, to check for correctness</span>
<span class="w">  </span><span class="n">C_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span>

<span class="w">  </span><span class="c"># Compute the reference timings</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="c"># Make sure that we have the right answer!</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">C_ref</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Print the reference implementation timing</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">  |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="w">  </span><span class="c"># Compute the timing for mygemm! implementation</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Compute the error (difference between our implementation and the reference)</span>
<span class="w">  </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">C</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">C_ref</span><span class="p">,</span><span class="w"> </span><span class="nb">Inf</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Print mygemm! implementations</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">   </span><span class="si">%.2e</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">err</span><span class="p">)</span>

<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot!</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">,</span><span class="w"> </span><span class="n">xlabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m = n = k&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GFLOPs/S&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$mygemm!</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size |      reference      |           mygemm_ijp!
     |   seconds   GFLOPS  |   seconds   GFLOPS     err
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  48 |  6.65e-06    33.26  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4.49e-05     4.92   7.11e-15
  96 |  2.93e-05    60.32  |  3.43e-04     5.16   1.42e-14
 144 |  1.03e-04    58.13  |  1.25e-03     4.76   3.55e-14
 192 |  2.32e-04    60.91  |  4.83e-03     2.93   3.55e-14
 240 |  4.65e-04    59.41  |  6.41e-03     4.31   5.68e-14
 288 |  7.98e-04    59.87  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.62e-02     2.95   1.85e-13
 336 |  1.23e-03    61.83  |  1.79e-02     4.25   2.13e-13
 384 |  1.85e-03    61.19  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3.90e-02     2.90   2.42e-13
 432 |  2.77e-03    58.29  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4.63e-02     3.48   2.84e-13
 480 |  3.59e-03    61.67  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7.67e-02     2.88   3.41e-13
</pre></div>
</div>
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip630">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip630)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip631">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip630)" d="M220.19 1423.18 L2352.76 1423.18 L2352.76 47.2441 L220.19 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip632">
    <rect x="220" y="47" width="2134" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="522.714,1423.18 522.714,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="988.421,1423.18 988.421,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1454.13,1423.18 1454.13,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1919.83,1423.18 1919.83,47.2441 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="220.19,1317.11 2352.76,1317.11 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="220.19,1031.92 2352.76,1031.92 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="220.19,746.739 2352.76,746.739 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="220.19,461.555 2352.76,461.555 "/>
<polyline clip-path="url(#clip632)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="220.19,176.371 2352.76,176.371 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="522.714,1423.18 522.714,1404.28 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="988.421,1423.18 988.421,1404.28 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1454.13,1423.18 1454.13,1404.28 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1919.83,1423.18 1919.83,1404.28 "/>
<path clip-path="url(#clip630)" d="M482.32 1481.64 L489.959 1481.64 L489.959 1455.28 L481.649 1456.95 L481.649 1452.69 L489.913 1451.02 L494.589 1451.02 L494.589 1481.64 L502.228 1481.64 L502.228 1485.58 L482.32 1485.58 L482.32 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M521.672 1454.1 Q518.061 1454.1 516.232 1457.66 Q514.427 1461.2 514.427 1468.33 Q514.427 1475.44 516.232 1479.01 Q518.061 1482.55 521.672 1482.55 Q525.306 1482.55 527.112 1479.01 Q528.94 1475.44 528.94 1468.33 Q528.94 1461.2 527.112 1457.66 Q525.306 1454.1 521.672 1454.1 M521.672 1450.39 Q527.482 1450.39 530.538 1455 Q533.616 1459.58 533.616 1468.33 Q533.616 1477.06 530.538 1481.67 Q527.482 1486.25 521.672 1486.25 Q515.862 1486.25 512.783 1481.67 Q509.728 1477.06 509.728 1468.33 Q509.728 1459.58 512.783 1455 Q515.862 1450.39 521.672 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M551.834 1454.1 Q548.223 1454.1 546.394 1457.66 Q544.588 1461.2 544.588 1468.33 Q544.588 1475.44 546.394 1479.01 Q548.223 1482.55 551.834 1482.55 Q555.468 1482.55 557.274 1479.01 Q559.102 1475.44 559.102 1468.33 Q559.102 1461.2 557.274 1457.66 Q555.468 1454.1 551.834 1454.1 M551.834 1450.39 Q557.644 1450.39 560.7 1455 Q563.778 1459.58 563.778 1468.33 Q563.778 1477.06 560.7 1481.67 Q557.644 1486.25 551.834 1486.25 Q546.024 1486.25 542.945 1481.67 Q539.889 1477.06 539.889 1468.33 Q539.889 1459.58 542.945 1455 Q546.024 1450.39 551.834 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M952.113 1481.64 L968.432 1481.64 L968.432 1485.58 L946.488 1485.58 L946.488 1481.64 Q949.15 1478.89 953.733 1474.26 Q958.34 1469.61 959.52 1468.27 Q961.766 1465.74 962.645 1464.01 Q963.548 1462.25 963.548 1460.56 Q963.548 1457.8 961.604 1456.07 Q959.682 1454.33 956.581 1454.33 Q954.381 1454.33 951.928 1455.09 Q949.497 1455.86 946.719 1457.41 L946.719 1452.69 Q949.544 1451.55 951.997 1450.97 Q954.451 1450.39 956.488 1450.39 Q961.858 1450.39 965.053 1453.08 Q968.247 1455.77 968.247 1460.26 Q968.247 1462.39 967.437 1464.31 Q966.65 1466.2 964.543 1468.8 Q963.965 1469.47 960.863 1472.69 Q957.761 1475.88 952.113 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M988.247 1454.1 Q984.636 1454.1 982.807 1457.66 Q981.002 1461.2 981.002 1468.33 Q981.002 1475.44 982.807 1479.01 Q984.636 1482.55 988.247 1482.55 Q991.881 1482.55 993.687 1479.01 Q995.516 1475.44 995.516 1468.33 Q995.516 1461.2 993.687 1457.66 Q991.881 1454.1 988.247 1454.1 M988.247 1450.39 Q994.057 1450.39 997.113 1455 Q1000.19 1459.58 1000.19 1468.33 Q1000.19 1477.06 997.113 1481.67 Q994.057 1486.25 988.247 1486.25 Q982.437 1486.25 979.358 1481.67 Q976.303 1477.06 976.303 1468.33 Q976.303 1459.58 979.358 1455 Q982.437 1450.39 988.247 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1018.41 1454.1 Q1014.8 1454.1 1012.97 1457.66 Q1011.16 1461.2 1011.16 1468.33 Q1011.16 1475.44 1012.97 1479.01 Q1014.8 1482.55 1018.41 1482.55 Q1022.04 1482.55 1023.85 1479.01 Q1025.68 1475.44 1025.68 1468.33 Q1025.68 1461.2 1023.85 1457.66 Q1022.04 1454.1 1018.41 1454.1 M1018.41 1450.39 Q1024.22 1450.39 1027.27 1455 Q1030.35 1459.58 1030.35 1468.33 Q1030.35 1477.06 1027.27 1481.67 Q1024.22 1486.25 1018.41 1486.25 Q1012.6 1486.25 1009.52 1481.67 Q1006.46 1477.06 1006.46 1468.33 Q1006.46 1459.58 1009.52 1455 Q1012.6 1450.39 1018.41 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1427.89 1466.95 Q1431.25 1467.66 1433.12 1469.93 Q1435.02 1472.2 1435.02 1475.53 Q1435.02 1480.65 1431.5 1483.45 Q1427.98 1486.25 1421.5 1486.25 Q1419.32 1486.25 1417.01 1485.81 Q1414.72 1485.39 1412.26 1484.54 L1412.26 1480.02 Q1414.21 1481.16 1416.52 1481.74 Q1418.84 1482.32 1421.36 1482.32 Q1425.76 1482.32 1428.05 1480.58 Q1430.37 1478.84 1430.37 1475.53 Q1430.37 1472.48 1428.21 1470.77 Q1426.08 1469.03 1422.26 1469.03 L1418.24 1469.03 L1418.24 1465.19 L1422.45 1465.19 Q1425.9 1465.19 1427.73 1463.82 Q1429.56 1462.43 1429.56 1459.84 Q1429.56 1457.18 1427.66 1455.77 Q1425.78 1454.33 1422.26 1454.33 Q1420.34 1454.33 1418.14 1454.75 Q1415.94 1455.16 1413.31 1456.04 L1413.31 1451.88 Q1415.97 1451.14 1418.28 1450.77 Q1420.62 1450.39 1422.68 1450.39 Q1428.01 1450.39 1431.11 1452.83 Q1434.21 1455.23 1434.21 1459.35 Q1434.21 1462.22 1432.57 1464.21 Q1430.92 1466.18 1427.89 1466.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1453.88 1454.1 Q1450.27 1454.1 1448.44 1457.66 Q1446.64 1461.2 1446.64 1468.33 Q1446.64 1475.44 1448.44 1479.01 Q1450.27 1482.55 1453.88 1482.55 Q1457.52 1482.55 1459.32 1479.01 Q1461.15 1475.44 1461.15 1468.33 Q1461.15 1461.2 1459.32 1457.66 Q1457.52 1454.1 1453.88 1454.1 M1453.88 1450.39 Q1459.69 1450.39 1462.75 1455 Q1465.83 1459.58 1465.83 1468.33 Q1465.83 1477.06 1462.75 1481.67 Q1459.69 1486.25 1453.88 1486.25 Q1448.07 1486.25 1445 1481.67 Q1441.94 1477.06 1441.94 1468.33 Q1441.94 1459.58 1445 1455 Q1448.07 1450.39 1453.88 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1484.05 1454.1 Q1480.44 1454.1 1478.61 1457.66 Q1476.8 1461.2 1476.8 1468.33 Q1476.8 1475.44 1478.61 1479.01 Q1480.44 1482.55 1484.05 1482.55 Q1487.68 1482.55 1489.49 1479.01 Q1491.31 1475.44 1491.31 1468.33 Q1491.31 1461.2 1489.49 1457.66 Q1487.68 1454.1 1484.05 1454.1 M1484.05 1450.39 Q1489.86 1450.39 1492.91 1455 Q1495.99 1459.58 1495.99 1468.33 Q1495.99 1477.06 1492.91 1481.67 Q1489.86 1486.25 1484.05 1486.25 Q1478.24 1486.25 1475.16 1481.67 Q1472.1 1477.06 1472.1 1468.33 Q1472.1 1459.58 1475.16 1455 Q1478.24 1450.39 1484.05 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1892.93 1455.09 L1881.12 1473.54 L1892.93 1473.54 L1892.93 1455.09 M1891.7 1451.02 L1897.58 1451.02 L1897.58 1473.54 L1902.51 1473.54 L1902.51 1477.43 L1897.58 1477.43 L1897.58 1485.58 L1892.93 1485.58 L1892.93 1477.43 L1877.32 1477.43 L1877.32 1472.92 L1891.7 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1920.24 1454.1 Q1916.63 1454.1 1914.8 1457.66 Q1912.99 1461.2 1912.99 1468.33 Q1912.99 1475.44 1914.8 1479.01 Q1916.63 1482.55 1920.24 1482.55 Q1923.87 1482.55 1925.68 1479.01 Q1927.51 1475.44 1927.51 1468.33 Q1927.51 1461.2 1925.68 1457.66 Q1923.87 1454.1 1920.24 1454.1 M1920.24 1450.39 Q1926.05 1450.39 1929.11 1455 Q1932.18 1459.58 1932.18 1468.33 Q1932.18 1477.06 1929.11 1481.67 Q1926.05 1486.25 1920.24 1486.25 Q1914.43 1486.25 1911.35 1481.67 Q1908.3 1477.06 1908.3 1468.33 Q1908.3 1459.58 1911.35 1455 Q1914.43 1450.39 1920.24 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1950.4 1454.1 Q1946.79 1454.1 1944.96 1457.66 Q1943.16 1461.2 1943.16 1468.33 Q1943.16 1475.44 1944.96 1479.01 Q1946.79 1482.55 1950.4 1482.55 Q1954.04 1482.55 1955.84 1479.01 Q1957.67 1475.44 1957.67 1468.33 Q1957.67 1461.2 1955.84 1457.66 Q1954.04 1454.1 1950.4 1454.1 M1950.4 1450.39 Q1956.21 1450.39 1959.27 1455 Q1962.35 1459.58 1962.35 1468.33 Q1962.35 1477.06 1959.27 1481.67 Q1956.21 1486.25 1950.4 1486.25 Q1944.59 1486.25 1941.51 1481.67 Q1938.46 1477.06 1938.46 1468.33 Q1938.46 1459.58 1941.51 1455 Q1944.59 1450.39 1950.4 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1150.17 1539.24 Q1152.36 1535.29 1155.42 1533.41 Q1158.47 1531.54 1162.61 1531.54 Q1168.18 1531.54 1171.21 1535.45 Q1174.23 1539.33 1174.23 1546.53 L1174.23 1568.04 L1168.34 1568.04 L1168.34 1546.72 Q1168.34 1541.59 1166.53 1539.11 Q1164.71 1536.63 1160.99 1536.63 Q1156.44 1536.63 1153.8 1539.65 Q1151.15 1542.68 1151.15 1547.9 L1151.15 1568.04 L1145.27 1568.04 L1145.27 1546.72 Q1145.27 1541.56 1143.45 1539.11 Q1141.64 1536.63 1137.85 1536.63 Q1133.36 1536.63 1130.72 1539.68 Q1128.08 1542.71 1128.08 1547.9 L1128.08 1568.04 L1122.19 1568.04 L1122.19 1532.4 L1128.08 1532.4 L1128.08 1537.93 Q1130.08 1534.66 1132.88 1533.1 Q1135.69 1531.54 1139.54 1531.54 Q1143.42 1531.54 1146.13 1533.51 Q1148.86 1535.48 1150.17 1539.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1207.4 1538.44 L1248.2 1538.44 L1248.2 1543.79 L1207.4 1543.79 L1207.4 1538.44 M1207.4 1551.43 L1248.2 1551.43 L1248.2 1556.84 L1207.4 1556.84 L1207.4 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1311.6 1546.53 L1311.6 1568.04 L1305.75 1568.04 L1305.75 1546.72 Q1305.75 1541.66 1303.77 1539.14 Q1301.8 1536.63 1297.85 1536.63 Q1293.11 1536.63 1290.37 1539.65 Q1287.63 1542.68 1287.63 1547.9 L1287.63 1568.04 L1281.75 1568.04 L1281.75 1532.4 L1287.63 1532.4 L1287.63 1537.93 Q1289.74 1534.72 1292.57 1533.13 Q1295.43 1531.54 1299.16 1531.54 Q1305.3 1531.54 1308.45 1535.36 Q1311.6 1539.14 1311.6 1546.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1344.77 1538.44 L1385.57 1538.44 L1385.57 1543.79 L1344.77 1543.79 L1344.77 1538.44 M1344.77 1551.43 L1385.57 1551.43 L1385.57 1556.84 L1344.77 1556.84 L1344.77 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M1419.12 1518.52 L1425.01 1518.52 L1425.01 1547.77 L1442.48 1532.4 L1449.96 1532.4 L1431.05 1549.07 L1450.76 1568.04 L1443.12 1568.04 L1425.01 1550.63 L1425.01 1568.04 L1419.12 1568.04 L1419.12 1518.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,1423.18 220.19,47.2441 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,1317.11 239.088,1317.11 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,1031.92 239.088,1031.92 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,746.739 239.088,746.739 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,461.555 239.088,461.555 "/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="220.19,176.371 239.088,176.371 "/>
<path clip-path="url(#clip630)" d="M131.181 1315.75 Q134.538 1316.47 136.413 1318.74 Q138.311 1321.01 138.311 1324.34 Q138.311 1329.46 134.792 1332.26 Q131.274 1335.06 124.793 1335.06 Q122.617 1335.06 120.302 1334.62 Q118.01 1334.2 115.556 1333.34 L115.556 1328.83 Q117.501 1329.96 119.816 1330.54 Q122.13 1331.12 124.654 1331.12 Q129.052 1331.12 131.343 1329.39 Q133.658 1327.65 133.658 1324.34 Q133.658 1321.28 131.505 1319.57 Q129.376 1317.83 125.556 1317.83 L121.529 1317.83 L121.529 1313.99 L125.742 1313.99 Q129.191 1313.99 131.019 1312.63 Q132.848 1311.24 132.848 1308.65 Q132.848 1305.98 130.95 1304.57 Q129.075 1303.14 125.556 1303.14 Q123.635 1303.14 121.436 1303.55 Q119.237 1303.97 116.598 1304.85 L116.598 1300.68 Q119.26 1299.94 121.575 1299.57 Q123.913 1299.2 125.973 1299.2 Q131.297 1299.2 134.399 1301.63 Q137.501 1304.04 137.501 1308.16 Q137.501 1311.03 135.857 1313.02 Q134.214 1314.99 131.181 1315.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M147.177 1328.51 L152.061 1328.51 L152.061 1334.39 L147.177 1334.39 L147.177 1328.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M172.246 1302.9 Q168.635 1302.9 166.806 1306.47 Q165.001 1310.01 165.001 1317.14 Q165.001 1324.25 166.806 1327.81 Q168.635 1331.35 172.246 1331.35 Q175.88 1331.35 177.686 1327.81 Q179.514 1324.25 179.514 1317.14 Q179.514 1310.01 177.686 1306.47 Q175.88 1302.9 172.246 1302.9 M172.246 1299.2 Q178.056 1299.2 181.112 1303.81 Q184.19 1308.39 184.19 1317.14 Q184.19 1325.87 181.112 1330.47 Q178.056 1335.06 172.246 1335.06 Q166.436 1335.06 163.357 1330.47 Q160.302 1325.87 160.302 1317.14 Q160.302 1308.39 163.357 1303.81 Q166.436 1299.2 172.246 1299.2 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M132.177 1030.57 Q135.533 1031.29 137.408 1033.55 Q139.306 1035.82 139.306 1039.16 Q139.306 1044.27 135.788 1047.07 Q132.269 1049.87 125.788 1049.87 Q123.612 1049.87 121.297 1049.43 Q119.006 1049.02 116.552 1048.16 L116.552 1043.65 Q118.496 1044.78 120.811 1045.36 Q123.126 1045.94 125.649 1045.94 Q130.047 1045.94 132.339 1044.2 Q134.654 1042.47 134.654 1039.16 Q134.654 1036.1 132.501 1034.39 Q130.371 1032.65 126.552 1032.65 L122.524 1032.65 L122.524 1028.81 L126.737 1028.81 Q130.186 1028.81 132.015 1027.44 Q133.843 1026.05 133.843 1023.46 Q133.843 1020.8 131.945 1019.39 Q130.07 1017.95 126.552 1017.95 Q124.63 1017.95 122.431 1018.37 Q120.232 1018.79 117.593 1019.67 L117.593 1015.5 Q120.255 1014.76 122.57 1014.39 Q124.908 1014.02 126.968 1014.02 Q132.292 1014.02 135.394 1016.45 Q138.496 1018.86 138.496 1022.98 Q138.496 1025.85 136.853 1027.84 Q135.209 1029.8 132.177 1030.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M148.172 1043.32 L153.056 1043.32 L153.056 1049.2 L148.172 1049.2 L148.172 1043.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M163.288 1014.64 L181.644 1014.64 L181.644 1018.58 L167.57 1018.58 L167.57 1027.05 Q168.589 1026.7 169.607 1026.54 Q170.626 1026.35 171.644 1026.35 Q177.431 1026.35 180.811 1029.53 Q184.19 1032.7 184.19 1038.11 Q184.19 1043.69 180.718 1046.79 Q177.246 1049.87 170.927 1049.87 Q168.751 1049.87 166.482 1049.5 Q164.237 1049.13 161.829 1048.39 L161.829 1043.69 Q163.913 1044.83 166.135 1045.38 Q168.357 1045.94 170.834 1045.94 Q174.839 1045.94 177.176 1043.83 Q179.514 1041.73 179.514 1038.11 Q179.514 1034.5 177.176 1032.4 Q174.839 1030.29 170.834 1030.29 Q168.959 1030.29 167.084 1030.71 Q165.232 1031.12 163.288 1032 L163.288 1014.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M129.862 733.533 L118.056 751.982 L129.862 751.982 L129.862 733.533 M128.635 729.459 L134.515 729.459 L134.515 751.982 L139.445 751.982 L139.445 755.87 L134.515 755.87 L134.515 764.019 L129.862 764.019 L129.862 755.87 L114.26 755.87 L114.26 751.357 L128.635 729.459 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M147.177 758.139 L152.061 758.139 L152.061 764.019 L147.177 764.019 L147.177 758.139 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M172.246 732.537 Q168.635 732.537 166.806 736.102 Q165.001 739.644 165.001 746.773 Q165.001 753.88 166.806 757.444 Q168.635 760.986 172.246 760.986 Q175.88 760.986 177.686 757.444 Q179.514 753.88 179.514 746.773 Q179.514 739.644 177.686 736.102 Q175.88 732.537 172.246 732.537 M172.246 728.834 Q178.056 728.834 181.112 733.44 Q184.19 738.023 184.19 746.773 Q184.19 755.5 181.112 760.107 Q178.056 764.69 172.246 764.69 Q166.436 764.69 163.357 760.107 Q160.302 755.5 160.302 746.773 Q160.302 738.023 163.357 733.44 Q166.436 728.834 172.246 728.834 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M130.857 448.349 L119.052 466.798 L130.857 466.798 L130.857 448.349 M129.63 444.275 L135.51 444.275 L135.51 466.798 L140.441 466.798 L140.441 470.687 L135.51 470.687 L135.51 478.835 L130.857 478.835 L130.857 470.687 L115.256 470.687 L115.256 466.173 L129.63 444.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M148.172 472.955 L153.056 472.955 L153.056 478.835 L148.172 478.835 L148.172 472.955 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M163.288 444.275 L181.644 444.275 L181.644 448.21 L167.57 448.21 L167.57 456.682 Q168.589 456.335 169.607 456.173 Q170.626 455.988 171.644 455.988 Q177.431 455.988 180.811 459.159 Q184.19 462.33 184.19 467.747 Q184.19 473.326 180.718 476.428 Q177.246 479.506 170.927 479.506 Q168.751 479.506 166.482 479.136 Q164.237 478.766 161.829 478.025 L161.829 473.326 Q163.913 474.46 166.135 475.016 Q168.357 475.571 170.834 475.571 Q174.839 475.571 177.176 473.465 Q179.514 471.358 179.514 467.747 Q179.514 464.136 177.176 462.03 Q174.839 459.923 170.834 459.923 Q168.959 459.923 167.084 460.34 Q165.232 460.756 163.288 461.636 L163.288 444.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M117.061 159.091 L135.417 159.091 L135.417 163.027 L121.343 163.027 L121.343 171.499 Q122.362 171.152 123.38 170.989 Q124.399 170.804 125.418 170.804 Q131.205 170.804 134.584 173.976 Q137.964 177.147 137.964 182.563 Q137.964 188.142 134.492 191.244 Q131.019 194.323 124.7 194.323 Q122.524 194.323 120.255 193.952 Q118.01 193.582 115.603 192.841 L115.603 188.142 Q117.686 189.276 119.908 189.832 Q122.13 190.388 124.607 190.388 Q128.612 190.388 130.95 188.281 Q133.288 186.175 133.288 182.563 Q133.288 178.952 130.95 176.846 Q128.612 174.739 124.607 174.739 Q122.732 174.739 120.857 175.156 Q119.006 175.573 117.061 176.452 L117.061 159.091 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M147.177 187.772 L152.061 187.772 L152.061 193.651 L147.177 193.651 L147.177 187.772 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M172.246 162.17 Q168.635 162.17 166.806 165.735 Q165.001 169.277 165.001 176.406 Q165.001 183.513 166.806 187.077 Q168.635 190.619 172.246 190.619 Q175.88 190.619 177.686 187.077 Q179.514 183.513 179.514 176.406 Q179.514 169.277 177.686 165.735 Q175.88 162.17 172.246 162.17 M172.246 158.466 Q178.056 158.466 181.112 163.073 Q184.19 167.656 184.19 176.406 Q184.19 185.133 181.112 189.739 Q178.056 194.323 172.246 194.323 Q166.436 194.323 163.357 189.739 Q160.302 185.133 160.302 176.406 Q160.302 167.656 163.357 163.073 Q166.436 158.466 172.246 158.466 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M57.2247 850.813 L44.4614 850.813 L44.4614 861.317 L39.1779 861.317 L39.1779 844.447 L59.58 844.447 Q62.2218 848.171 63.5904 852.659 Q64.9272 857.147 64.9272 862.24 Q64.9272 873.38 58.4342 879.682 Q51.9093 885.952 40.2919 885.952 Q28.6427 885.952 22.1496 879.682 Q15.6248 873.38 15.6248 862.24 Q15.6248 857.593 16.7706 853.423 Q17.9164 849.222 20.1444 845.689 L26.9876 845.689 Q23.9639 849.254 22.4361 853.264 Q20.9083 857.274 20.9083 861.699 Q20.9083 870.42 25.7781 874.812 Q30.6479 879.172 40.2919 879.172 Q49.9041 879.172 54.7739 874.812 Q59.6436 870.42 59.6436 861.699 Q59.6436 858.293 59.0707 855.619 Q58.466 852.946 57.2247 850.813 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M16.4842 832.703 L16.4842 805.394 L21.895 805.394 L21.895 826.273 L35.8996 826.273 L35.8996 807.431 L41.3104 807.431 L41.3104 826.273 L64.0042 826.273 L64.0042 832.703 L16.4842 832.703 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M16.4842 795.209 L16.4842 788.779 L58.5933 788.779 L58.5933 765.64 L64.0042 765.64 L64.0042 795.209 L16.4842 795.209 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M20.8447 741.928 Q20.8447 748.93 26.0645 753.068 Q31.2844 757.174 40.2919 757.174 Q49.2675 757.174 54.4874 753.068 Q59.7073 748.93 59.7073 741.928 Q59.7073 734.926 54.4874 730.851 Q49.2675 726.746 40.2919 726.746 Q31.2844 726.746 26.0645 730.851 Q20.8447 734.926 20.8447 741.928 M15.6248 741.928 Q15.6248 731.934 22.3406 725.95 Q29.0246 719.966 40.2919 719.966 Q51.5274 719.966 58.2432 725.95 Q64.9272 731.934 64.9272 741.928 Q64.9272 751.954 58.2432 757.969 Q51.5592 763.953 40.2919 763.953 Q29.0246 763.953 22.3406 757.969 Q15.6248 751.954 15.6248 741.928 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M21.7677 703.479 L39.6235 703.479 L39.6235 695.394 Q39.6235 690.907 37.3 688.456 Q34.9765 686.005 30.6797 686.005 Q26.4147 686.005 24.0912 688.456 Q21.7677 690.907 21.7677 695.394 L21.7677 703.479 M16.4842 709.908 L16.4842 695.394 Q16.4842 687.406 20.1126 683.331 Q23.7092 679.226 30.6797 679.226 Q37.7138 679.226 41.3104 683.331 Q44.907 687.406 44.907 695.394 L44.907 703.479 L64.0042 703.479 L64.0042 709.908 L16.4842 709.908 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M29.4065 649.275 L34.9447 649.275 Q33.6716 651.758 33.035 654.431 Q32.3984 657.105 32.3984 659.969 Q32.3984 664.33 33.7352 666.526 Q35.072 668.69 37.7456 668.69 Q39.7826 668.69 40.9603 667.131 Q42.1061 665.571 43.1565 660.861 L43.6021 658.855 Q44.9389 652.617 47.3897 650.007 Q49.8086 647.365 54.1691 647.365 Q59.1344 647.365 62.0308 651.312 Q64.9272 655.227 64.9272 662.102 Q64.9272 664.966 64.3543 668.086 Q63.8132 671.173 62.6992 674.61 L56.6518 674.61 Q58.3387 671.364 59.198 668.213 Q60.0256 665.062 60.0256 661.975 Q60.0256 657.837 58.6251 655.609 Q57.1929 653.381 54.6147 653.381 Q52.2276 653.381 50.9545 655.004 Q49.6813 656.595 48.5037 662.038 L48.0262 664.075 Q46.8804 669.518 44.5251 671.937 Q42.138 674.356 38.0002 674.356 Q32.9713 674.356 30.2341 670.791 Q27.4968 667.226 27.4968 660.67 Q27.4968 657.423 27.9743 654.558 Q28.4517 651.694 29.4065 649.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M16.4842 627.632 L16.4842 622.221 L70.0516 638.772 L70.0516 644.182 L16.4842 627.632 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M18.0438 587.337 L24.314 587.337 Q22.5634 590.997 21.704 594.243 Q20.8447 597.49 20.8447 600.514 Q20.8447 605.765 22.8817 608.63 Q24.9187 611.463 28.6745 611.463 Q31.8255 611.463 33.4488 609.585 Q35.0402 607.675 36.0269 602.391 L36.8226 598.508 Q38.1912 591.315 41.6605 587.91 Q45.098 584.472 50.8908 584.472 Q57.7976 584.472 61.3624 589.119 Q64.9272 593.734 64.9272 602.678 Q64.9272 606.052 64.1633 609.871 Q63.3994 613.659 61.9035 617.733 L55.2831 617.733 Q57.4793 613.818 58.5933 610.062 Q59.7073 606.306 59.7073 602.678 Q59.7073 597.172 57.543 594.18 Q55.3786 591.188 51.3682 591.188 Q47.8671 591.188 45.8937 593.352 Q43.9204 595.485 42.9337 600.386 L42.1698 604.301 Q40.7375 611.494 37.682 614.709 Q34.6264 617.924 29.1837 617.924 Q22.8817 617.924 19.2532 613.5 Q15.6248 609.044 15.6248 601.246 Q15.6248 597.904 16.2295 594.434 Q16.8343 590.965 18.0438 587.337 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip632)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="280.546,221.433 504.085,86.1857 727.625,311.52 951.164,1357.29 1174.7,569.154 1398.24,1343.37 1621.78,605.239 1845.32,1372.55 2068.86,1042.25 2292.4,1384.24 "/>
<path clip-path="url(#clip630)" d="M1754.87 196.789 L2281.67 196.789 L2281.67 93.1086 L1754.87 93.1086  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip630)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.87,196.789 2281.67,196.789 2281.67,93.1086 1754.87,93.1086 1754.87,196.789 "/>
<polyline clip-path="url(#clip630)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="1778.57,144.949 1920.74,144.949 "/>
<path clip-path="url(#clip630)" d="M1964.78 141.28 Q1966.38 138.409 1968.6 137.044 Q1970.82 135.678 1973.83 135.678 Q1977.88 135.678 1980.08 138.525 Q1982.28 141.349 1982.28 146.581 L1982.28 162.229 L1978 162.229 L1978 146.719 Q1978 142.993 1976.68 141.187 Q1975.36 139.382 1972.65 139.382 Q1969.34 139.382 1967.42 141.581 Q1965.5 143.78 1965.5 147.576 L1965.5 162.229 L1961.22 162.229 L1961.22 146.719 Q1961.22 142.969 1959.9 141.187 Q1958.58 139.382 1955.82 139.382 Q1952.56 139.382 1950.64 141.604 Q1948.72 143.803 1948.72 147.576 L1948.72 162.229 L1944.44 162.229 L1944.44 136.303 L1948.72 136.303 L1948.72 140.331 Q1950.18 137.946 1952.21 136.812 Q1954.25 135.678 1957.05 135.678 Q1959.87 135.678 1961.84 137.113 Q1963.83 138.548 1964.78 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2001.56 164.636 Q1999.76 169.266 1998.05 170.678 Q1996.33 172.09 1993.46 172.09 L1990.06 172.09 L1990.06 168.525 L1992.56 168.525 Q1994.32 168.525 1995.29 167.692 Q1996.26 166.858 1997.44 163.756 L1998.21 161.812 L1987.72 136.303 L1992.24 136.303 L2000.34 156.581 L2008.44 136.303 L2012.95 136.303 L2001.56 164.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2035.89 148.965 Q2035.89 144.335 2033.97 141.789 Q2032.07 139.243 2028.62 139.243 Q2025.2 139.243 2023.28 141.789 Q2021.38 144.335 2021.38 148.965 Q2021.38 153.571 2023.28 156.118 Q2025.2 158.664 2028.62 158.664 Q2032.07 158.664 2033.97 156.118 Q2035.89 153.571 2035.89 148.965 M2040.15 159.011 Q2040.15 165.631 2037.21 168.849 Q2034.27 172.09 2028.21 172.09 Q2025.96 172.09 2023.97 171.742 Q2021.98 171.418 2020.11 170.724 L2020.11 166.58 Q2021.98 167.599 2023.81 168.085 Q2025.64 168.571 2027.54 168.571 Q2031.73 168.571 2033.81 166.372 Q2035.89 164.196 2035.89 159.775 L2035.89 157.668 Q2034.57 159.96 2032.51 161.094 Q2030.45 162.229 2027.58 162.229 Q2022.81 162.229 2019.9 158.594 Q2016.98 154.96 2016.98 148.965 Q2016.98 142.946 2019.9 139.312 Q2022.81 135.678 2027.58 135.678 Q2030.45 135.678 2032.51 136.812 Q2034.57 137.946 2035.89 140.238 L2035.89 136.303 L2040.15 136.303 L2040.15 159.011 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2071.1 148.201 L2071.1 150.284 L2051.52 150.284 Q2051.8 154.682 2054.16 156.997 Q2056.54 159.289 2060.78 159.289 Q2063.23 159.289 2065.52 158.687 Q2067.84 158.085 2070.11 156.881 L2070.11 160.909 Q2067.81 161.881 2065.41 162.391 Q2063 162.9 2060.52 162.9 Q2054.32 162.9 2050.68 159.289 Q2047.07 155.678 2047.07 149.52 Q2047.07 143.155 2050.5 139.428 Q2053.95 135.678 2059.78 135.678 Q2065.01 135.678 2068.05 139.057 Q2071.1 142.414 2071.1 148.201 M2066.84 146.951 Q2066.8 143.456 2064.87 141.372 Q2062.98 139.289 2059.83 139.289 Q2056.26 139.289 2054.11 141.303 Q2051.98 143.317 2051.66 146.974 L2066.84 146.951 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2098.28 141.28 Q2099.87 138.409 2102.1 137.044 Q2104.32 135.678 2107.33 135.678 Q2111.38 135.678 2113.58 138.525 Q2115.78 141.349 2115.78 146.581 L2115.78 162.229 L2111.49 162.229 L2111.49 146.719 Q2111.49 142.993 2110.18 141.187 Q2108.86 139.382 2106.15 139.382 Q2102.84 139.382 2100.92 141.581 Q2098.99 143.78 2098.99 147.576 L2098.99 162.229 L2094.71 162.229 L2094.71 146.719 Q2094.71 142.969 2093.39 141.187 Q2092.07 139.382 2089.32 139.382 Q2086.05 139.382 2084.13 141.604 Q2082.21 143.803 2082.21 147.576 L2082.21 162.229 L2077.93 162.229 L2077.93 136.303 L2082.21 136.303 L2082.21 140.331 Q2083.67 137.946 2085.71 136.812 Q2087.74 135.678 2090.55 135.678 Q2093.37 135.678 2095.34 137.113 Q2097.33 138.548 2098.28 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2144.46 141.28 Q2146.05 138.409 2148.28 137.044 Q2150.5 135.678 2153.51 135.678 Q2157.56 135.678 2159.76 138.525 Q2161.96 141.349 2161.96 146.581 L2161.96 162.229 L2157.67 162.229 L2157.67 146.719 Q2157.67 142.993 2156.36 141.187 Q2155.04 139.382 2152.33 139.382 Q2149.02 139.382 2147.1 141.581 Q2145.17 143.78 2145.17 147.576 L2145.17 162.229 L2140.89 162.229 L2140.89 146.719 Q2140.89 142.969 2139.57 141.187 Q2138.25 139.382 2135.5 139.382 Q2132.24 139.382 2130.31 141.604 Q2128.39 143.803 2128.39 147.576 L2128.39 162.229 L2124.11 162.229 L2124.11 136.303 L2128.39 136.303 L2128.39 140.331 Q2129.85 137.946 2131.89 136.812 Q2133.92 135.678 2136.73 135.678 Q2139.55 135.678 2141.52 137.113 Q2143.51 138.548 2144.46 141.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2190.15 170.099 L2190.15 173.409 L2165.52 173.409 L2165.52 170.099 L2190.15 170.099 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2194.16 136.303 L2198.42 136.303 L2198.42 162.229 L2194.16 162.229 L2194.16 136.303 M2194.16 126.21 L2198.42 126.21 L2198.42 131.604 L2194.16 131.604 L2194.16 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2207.33 136.303 L2211.59 136.303 L2211.59 162.692 Q2211.59 167.645 2209.69 169.867 Q2207.81 172.09 2203.62 172.09 L2202 172.09 L2202 168.479 L2203.14 168.479 Q2205.57 168.479 2206.45 167.344 Q2207.33 166.233 2207.33 162.692 L2207.33 136.303 M2207.33 126.21 L2211.59 126.21 L2211.59 131.604 L2207.33 131.604 L2207.33 126.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2224.62 158.34 L2224.62 172.09 L2220.34 172.09 L2220.34 136.303 L2224.62 136.303 L2224.62 140.238 Q2225.96 137.923 2228 136.812 Q2230.06 135.678 2232.91 135.678 Q2237.63 135.678 2240.57 139.428 Q2243.53 143.178 2243.53 149.289 Q2243.53 155.4 2240.57 159.15 Q2237.63 162.9 2232.91 162.9 Q2230.06 162.9 2228 161.789 Q2225.96 160.655 2224.62 158.34 M2239.11 149.289 Q2239.11 144.59 2237.17 141.928 Q2235.24 139.243 2231.86 139.243 Q2228.48 139.243 2226.54 141.928 Q2224.62 144.59 2224.62 149.289 Q2224.62 153.988 2226.54 156.673 Q2228.48 159.335 2231.86 159.335 Q2235.24 159.335 2237.17 156.673 Q2239.11 153.988 2239.11 149.289 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip630)" d="M2253.28 156.349 L2257.98 156.349 L2257.98 162.229 L2253.28 162.229 L2253.28 156.349 M2253.28 127.669 L2257.98 127.669 L2257.98 142.831 L2257.51 151.094 L2253.76 151.094 L2253.28 142.831 L2253.28 127.669 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
</div></div>
</div>
<section id="questions-and-observations">
<h4>Questions and observations:<a class="headerlink" href="#questions-and-observations" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Why do some orderings get better performance?</p></li>
<li><p>For both the <code class="docutils literal notranslate"><span class="pre">jpi</span></code> (Algo 2.5) and <code class="docutils literal notranslate"><span class="pre">pji</span></code> (Algo 2.4) loop orderings, the inner loop accesses columns of <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(A\)</span>. However,</p>
<ul>
<li><p>Each execution of the inner loop of the <code class="docutils literal notranslate"><span class="pre">jpi</span></code> (Algo 2.5) ordering updates the same column of <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
<li><p>Each execution of the inner loop of the <code class="docutils literal notranslate"><span class="pre">pji</span></code> (Algo 2.4) ordering updates a different column of <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These results are influenced by the fact that Julia uses <strong>column-major</strong> storing of multidimensional arrays.</p>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sdsu-comp605/spring25",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="module2-1_measuring_performance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">6) Measuring Performance</p>
      </div>
    </a>
    <a class="right-next"
       href="module2-3_blocked_mmm.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">8) Blocked Matrix-Matrix Multiplication</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-cpu-optimization">1. Introduction to CPU Optimization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-matrix-multiply">1.1 Matrix-Matrix Multiply</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notation">Notation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering">2. Loop ordering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ijp">2.1 Loop ordering: ijp</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-ipj">2.2 Loop ordering: ipj</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pij">2.3 Loop ordering: pij</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-pji">2.4 Loop ordering: pji</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jpi">2.5 Loop ordering: jpi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loop-ordering-jip">2.6 Loop ordering: jip</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#questions-and-observations">Questions and observations:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valeria Barra
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>