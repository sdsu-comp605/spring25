
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>16) HW2 solution &#8212; Scientific Computing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/hw2_notebook';</script>
    <link rel="icon" href="../_static/SDSU-comp605_logo.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="17) Parallel reductions and scans" href="module5-1_reductions_and_scans.html" />
    <link rel="prev" title="15) Case Study 2: ClimaCore" href="module4-2_case_study_2_climacore.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-light" alt="Scientific Computing - Home"/>
    <script>document.write(`<img src="../_static/SDSU-comp605_logo.svg" class="logo__image only-dark" alt="Scientific Computing - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../lectures.html">Lectures</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module1-1_first_class.html">1) First Class: Reproducibility and Git</a></li>


<li class="toctree-l2"><a class="reference internal" href="module1-2_linux.html">2) The Linux Filesystem and commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-3_community_projects.html">3) Community Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-4_intro_architectures.html">4) Introduction to Computer Architectures</a></li>
<li class="toctree-l2"><a class="reference internal" href="module1-5_intro_vectorization.html">5) Introduction to Vectorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-1_measuring_performance.html">6) Measuring Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-2_cpu_optimization.html">7) CPU Optimization: Matrix-Matrix Multiply</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-3_blocked_mmm.html">8) Blocked Matrix-Matrix Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-4_packing_for_cache.html">9) Packing for cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="module2-5_intro_multithreading.html">10) Introduction to Multithreading</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-1_intro_parallel_scaling.html">11) Introduction to Parallel Scaling</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-2_intro_to_openmp.html">12) Introduction to OpenMP</a></li>
<li class="toctree-l2"><a class="reference internal" href="module3-3_openmp_tasks.html">13) More on OpenMP and OpenMP Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-1_case_study_1_libceed.html">14) Case Study 1: libCEED</a></li>
<li class="toctree-l2"><a class="reference internal" href="module4-2_case_study_2_climacore.html">15) Case Study 2: ClimaCore</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">16) HW2 solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-1_reductions_and_scans.html">17) Parallel reductions and scans</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-2_intro_to_mpi.html">18) Introduction to MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="module5-3_intro_to_slurm.html">19) Introduction to Batch Jobs</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sdsu-comp605/spring25/issues/new?title=Issue%20on%20page%20%2Flectures/hw2_notebook.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/hw2_notebook.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>16) HW2 solution</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hw2-solution">
<h1>16) HW2 solution<a class="headerlink" href="#hw2-solution" title="Link to this heading">#</a></h1>
<p>We want to solve the matrix multiplication problem</p>
<div class="math notranslate nohighlight">
\[
  C := C + A B^{T}. \qquad \qquad \qquad \qquad \hbox{(1)}
\]</div>
<p>Here <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span> have sizes <span class="math notranslate nohighlight">\(m \times k\)</span>, <span class="math notranslate nohighlight">\(n \times k\)</span>, and <span class="math notranslate nohighlight">\(m \times n\)</span>, respectively. Using the same <a class="reference external" href="https://sdsu-comp605.github.io/spring25/lectures/module2-2_cpu_optimization.html#notation">notation</a> that we’ve seen in class, where capital letters are typically for matrices, and lower case Greek letters for floating point scalars: <span class="math notranslate nohighlight">\(\alpha\)</span> (for entries of the matrix <span class="math notranslate nohighlight">\(A\)</span>), <span class="math notranslate nohighlight">\(\beta\)</span> (for entries of the matrix <span class="math notranslate nohighlight">\(B\)</span>), and <span class="math notranslate nohighlight">\(\gamma\)</span> (for entries of the matrix <span class="math notranslate nohighlight">\(C\)</span>).</p>
<p>Recognizing that the <span class="math notranslate nohighlight">\(pj\)</span> element of <span class="math notranslate nohighlight">\(B^{T}\)</span> is the <span class="math notranslate nohighlight">\(jp\)</span> element of <span class="math notranslate nohighlight">\(B\)</span>, it follows that the <span class="math notranslate nohighlight">\(ij\)</span> element of <span class="math notranslate nohighlight">\(C\)</span> can be computed as</p>
<div class="math notranslate nohighlight">
\[
  \gamma_{ij} := \gamma_{ij} + \sum_{p = 1}^{k} \alpha_{ip} \beta_{jp}.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c"># matrix times row vector (update rows of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ijp!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="c"># matrix times row vector (update rows of `C`) with inner axpy</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_ipj!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with rows of `B`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pij!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with columns of `A`</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_pji!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="c"># matrix times column vector (update columns of `C`) with inner axpy</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jpi!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="c"># matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="k">function</span><span class="w"> </span><span class="n">mygemm_jip!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="w">  </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">        </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mygemm_jip! (generic function with 1 method)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">## Testing</span>
<span class="c"># What modules / packages do we depend on</span>
<span class="k">using</span><span class="w"> </span><span class="n">Random</span>
<span class="k">using</span><span class="w"> </span><span class="n">LinearAlgebra</span>
<span class="k">using</span><span class="w"> </span><span class="n">Printf</span>
<span class="k">using</span><span class="w"> </span><span class="n">Plots</span>
<span class="n">default</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="c"># Plots embelishments</span>

<span class="c"># To ensure repeatability</span>
<span class="n">Random</span><span class="o">.</span><span class="n">seed!</span><span class="p">(</span><span class="mi">777</span><span class="p">)</span>

<span class="c"># Don&#39;t let BLAS use lots of threads (since we are not multi-threaded yet!)</span>
<span class="n">BLAS</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">include</span><span class="p">(</span><span class="s">&quot;../julia_codes/hw2_sol/mygemm.jl&quot;</span><span class="p">)</span>

<span class="c"># C := α * A * B + β * C</span>
<span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mul!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="o">&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)),</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">eltype</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span>

<span class="c"># matrix times row vector (update rows of `C`) with inner dot product</span>
<span class="c"># mygemm! = mygemm_ijp!</span>

<span class="c"># matrix times row vector (update rows of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_ipj!</span>

<span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with rows of `B`</span>
<span class="c"># mygemm! = mygemm_pij!</span>

<span class="c"># Rank one update (repeatedly update all elements of `C`) with outer product</span>
<span class="c"># using axpy with columns of `A`</span>
<span class="n">mygemm!</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mygemm_pji!</span>

<span class="c"># matrix times column vector (update columns of `C`) with inner axpy</span>
<span class="c"># mygemm! = mygemm_jpi!</span>

<span class="c"># matrix times column vector (update columns of `C`) with inner dot product</span>
<span class="c"># mygemm! = mygemm_jip!</span>

<span class="n">num_reps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="c"># What precision numbers to use</span>
<span class="n">FloatType1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float32</span>
<span class="n">FloatType2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span>

<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;size |      reference      |           </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">)</span>
<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;     |   seconds   GFLOPS  |   seconds   GFLOPS     diff</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">480</span>
<span class="n">best_perf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="c"># Size of square matrix to consider</span>
<span class="k">for</span><span class="w"> </span><span class="n">nmk</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">N</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Int</span><span class="p">(</span><span class="n">nmk</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nmk</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%4d</span><span class="s"> |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nmk</span><span class="p">)</span>

<span class="w">  </span><span class="n">gflops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-09</span>

<span class="w">  </span><span class="c"># Create some random initial data</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Make a copy of C for resetting data later</span>
<span class="w">  </span><span class="n">C_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="w">  </span><span class="c"># &quot;truth&quot;</span>
<span class="w">  </span><span class="n">C_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="o">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span>

<span class="w">  </span><span class="c"># Compute the reference timings</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType1</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="c"># Make sure that we have the right answer!</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">C_ref</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Print the reference implementation timing</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">  |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="w">  </span><span class="c"># Compute the timing for mygemm! implementation</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType1</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Compute the error (difference between our implementation and the reference)</span>
<span class="w">  </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">C</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">C_ref</span><span class="p">,</span><span class="w"> </span><span class="nb">Inf</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Print mygemm! implementations</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">   </span><span class="si">%.2e</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">diff</span><span class="p">)</span>

<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot!</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">,</span><span class="w"> </span><span class="n">xlabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m = n = k&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GFLOPs/S&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$mygemm!</span><span class="s"> </span><span class="si">$FloatType1</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Float32 Vs Float64&quot;</span><span class="p">)</span>


<span class="c">## FloatType2</span>

<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;size |      reference      |           </span><span class="si">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">)</span>
<span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;     |   seconds   GFLOPS  |   seconds   GFLOPS     diff</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

<span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">48</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mi">480</span>
<span class="n">best_perf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="c"># Size of square matrix to consider</span>
<span class="k">for</span><span class="w"> </span><span class="n">nmk</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">N</span>
<span class="w">  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Int</span><span class="p">(</span><span class="n">nmk</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nmk</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%4d</span><span class="s"> |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nmk</span><span class="p">)</span>

<span class="w">  </span><span class="n">gflops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1e-09</span>

<span class="w">  </span><span class="c"># Create some random initial data</span>
<span class="w">  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">(</span><span class="n">FloatType2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Make a copy of C for resetting data later</span>
<span class="w">  </span><span class="n">C_old</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="w">  </span><span class="c"># &quot;truth&quot;</span>
<span class="w">  </span><span class="n">C_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="o">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">C</span>

<span class="w">  </span><span class="c"># Compute the reference timings</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType2</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">refgemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="c"># Make sure that we have the right answer!</span>
<span class="w">  </span><span class="nd">@assert</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">≈</span><span class="w"> </span><span class="n">C_ref</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Print the reference implementation timing</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">  |&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="w">  </span><span class="c"># Compute the timing for mygemm! implementation</span>
<span class="w">  </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">typemax</span><span class="p">(</span><span class="n">FloatType2</span><span class="p">)</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">num_reps</span>
<span class="w">    </span><span class="c"># Reset C to the original data</span>
<span class="w">    </span><span class="n">C</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">C_old</span><span class="p">;</span>
<span class="w">    </span><span class="n">run_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nd">@elapsed</span><span class="w"> </span><span class="n">mygemm!</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">);</span>
<span class="w">    </span><span class="n">best_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">min</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gflops</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">best_time</span>

<span class="w">  </span><span class="c"># Compute the error (difference between our implementation and the reference)</span>
<span class="w">  </span><span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">norm</span><span class="p">(</span><span class="n">C</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">C_ref</span><span class="p">,</span><span class="w"> </span><span class="nb">Inf</span><span class="p">)</span>

<span class="w">  </span><span class="c"># Print mygemm! implementations</span>
<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;  </span><span class="si">%4.2e</span><span class="s"> </span><span class="si">%8.2f</span><span class="s">   </span><span class="si">%.2e</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">best_time</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">diff</span><span class="p">)</span>

<span class="w">  </span><span class="nd">@printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">plot!</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">best_perf</span><span class="p">,</span><span class="w"> </span><span class="n">xlabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;m = n = k&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GFLOPs/S&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="si">$mygemm!</span><span class="s"> </span><span class="si">$FloatType2</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Float32 Vs Float64&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size |      reference      |           mygemm_pji!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  48 |  5.97e-06    37.03  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.93e-05    11.45   4.77e-06
  96 |  3.14e-05    56.27  |  9.98e-05    17.73   1.72e-05
 144 |  9.10e-05    65.65  |  3.07e-04    19.48   2.67e-05
 192 |  2.03e-04    69.73  |  6.43e-04    22.01   3.81e-05
 240 |  3.79e-04    72.88  |  1.28e-03    21.68   5.34e-05
 288 |  6.34e-04    75.31  |  2.78e-03    17.18   8.39e-05
 336 |  1.16e-03    65.23  |  6.23e-03    12.18   1.14e-04
 384 |  1.72e-03    65.76  |  9.07e-03    12.49   1.45e-04
 432 |  2.42e-03    66.61  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.24e-02    12.97   1.68e-04
 480 |  2.91e-03    76.08  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1.45e-02    15.24   1.83e-04
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>size |      reference      |           mygemm_pji!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  1.12e-05    19.76  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2.65e-05     8.36   5.33e-15
  96 |  5.76e-05    30.71  |  1.62e-04    10.94   1.42e-14
 144 |  1.75e-04    34.03  |  5.08e-04    11.76   2.84e-14
 192 |  4.72e-04    29.99  |  1.98e-03     7.13   2.84e-14
 240 |  8.49e-04    32.55  |  4.12e-03     6.71   4.26e-14
 288 |  1.34e-03    35.78  |  6.55e-03     7.29   1.85e-13
 336 |  1.94e-03    39.01  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9.87e-03     7.68   2.13e-13
 384 |  2.83e-03    40.02  |  1.48e-02     7.66   2.56e-13
 432 |  3.93e-03    41.07  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2.10e-02     7.66   3.41e-13
 480 |  6.24e-03    35.44  |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  2.88e-02     7.67   3.41e-13
</pre></div>
</div>
<div class="output text_html"><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip410">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip410)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip411">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip410)" d="M202.737 1423.18 L2352.76 1423.18 L2352.76 123.472 L202.737 123.472  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip412">
    <rect x="202" y="123" width="2151" height="1301"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="507.736,1423.18 507.736,123.472 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="977.254,1423.18 977.254,123.472 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.77,1423.18 1446.77,123.472 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1916.29,1423.18 1916.29,123.472 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="202.737,1202.68 2352.76,1202.68 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="202.737,962.214 2352.76,962.214 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="202.737,721.747 2352.76,721.747 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="202.737,481.28 2352.76,481.28 "/>
<polyline clip-path="url(#clip412)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="202.737,240.813 2352.76,240.813 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="507.736,1423.18 507.736,1404.28 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="977.254,1423.18 977.254,1404.28 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.77,1423.18 1446.77,1404.28 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1916.29,1423.18 1916.29,1404.28 "/>
<path clip-path="url(#clip410)" d="M467.343 1481.64 L474.982 1481.64 L474.982 1455.28 L466.671 1456.95 L466.671 1452.69 L474.935 1451.02 L479.611 1451.02 L479.611 1481.64 L487.25 1481.64 L487.25 1485.58 L467.343 1485.58 L467.343 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M506.694 1454.1 Q503.083 1454.1 501.255 1457.66 Q499.449 1461.2 499.449 1468.33 Q499.449 1475.44 501.255 1479.01 Q503.083 1482.55 506.694 1482.55 Q510.329 1482.55 512.134 1479.01 Q513.963 1475.44 513.963 1468.33 Q513.963 1461.2 512.134 1457.66 Q510.329 1454.1 506.694 1454.1 M506.694 1450.39 Q512.504 1450.39 515.56 1455 Q518.639 1459.58 518.639 1468.33 Q518.639 1477.06 515.56 1481.67 Q512.504 1486.25 506.694 1486.25 Q500.884 1486.25 497.805 1481.67 Q494.75 1477.06 494.75 1468.33 Q494.75 1459.58 497.805 1455 Q500.884 1450.39 506.694 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M536.856 1454.1 Q533.245 1454.1 531.416 1457.66 Q529.611 1461.2 529.611 1468.33 Q529.611 1475.44 531.416 1479.01 Q533.245 1482.55 536.856 1482.55 Q540.49 1482.55 542.296 1479.01 Q544.125 1475.44 544.125 1468.33 Q544.125 1461.2 542.296 1457.66 Q540.49 1454.1 536.856 1454.1 M536.856 1450.39 Q542.666 1450.39 545.722 1455 Q548.801 1459.58 548.801 1468.33 Q548.801 1477.06 545.722 1481.67 Q542.666 1486.25 536.856 1486.25 Q531.046 1486.25 527.967 1481.67 Q524.912 1477.06 524.912 1468.33 Q524.912 1459.58 527.967 1455 Q531.046 1450.39 536.856 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M940.947 1481.64 L957.266 1481.64 L957.266 1485.58 L935.322 1485.58 L935.322 1481.64 Q937.984 1478.89 942.567 1474.26 Q947.174 1469.61 948.354 1468.27 Q950.6 1465.74 951.479 1464.01 Q952.382 1462.25 952.382 1460.56 Q952.382 1457.8 950.437 1456.07 Q948.516 1454.33 945.414 1454.33 Q943.215 1454.33 940.762 1455.09 Q938.331 1455.86 935.553 1457.41 L935.553 1452.69 Q938.377 1451.55 940.831 1450.97 Q943.285 1450.39 945.322 1450.39 Q950.692 1450.39 953.887 1453.08 Q957.081 1455.77 957.081 1460.26 Q957.081 1462.39 956.271 1464.31 Q955.484 1466.2 953.377 1468.8 Q952.799 1469.47 949.697 1472.69 Q946.595 1475.88 940.947 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M977.081 1454.1 Q973.47 1454.1 971.641 1457.66 Q969.836 1461.2 969.836 1468.33 Q969.836 1475.44 971.641 1479.01 Q973.47 1482.55 977.081 1482.55 Q980.715 1482.55 982.521 1479.01 Q984.349 1475.44 984.349 1468.33 Q984.349 1461.2 982.521 1457.66 Q980.715 1454.1 977.081 1454.1 M977.081 1450.39 Q982.891 1450.39 985.947 1455 Q989.025 1459.58 989.025 1468.33 Q989.025 1477.06 985.947 1481.67 Q982.891 1486.25 977.081 1486.25 Q971.271 1486.25 968.192 1481.67 Q965.136 1477.06 965.136 1468.33 Q965.136 1459.58 968.192 1455 Q971.271 1450.39 977.081 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1007.24 1454.1 Q1003.63 1454.1 1001.8 1457.66 Q999.997 1461.2 999.997 1468.33 Q999.997 1475.44 1001.8 1479.01 Q1003.63 1482.55 1007.24 1482.55 Q1010.88 1482.55 1012.68 1479.01 Q1014.51 1475.44 1014.51 1468.33 Q1014.51 1461.2 1012.68 1457.66 Q1010.88 1454.1 1007.24 1454.1 M1007.24 1450.39 Q1013.05 1450.39 1016.11 1455 Q1019.19 1459.58 1019.19 1468.33 Q1019.19 1477.06 1016.11 1481.67 Q1013.05 1486.25 1007.24 1486.25 Q1001.43 1486.25 998.354 1481.67 Q995.298 1477.06 995.298 1468.33 Q995.298 1459.58 998.354 1455 Q1001.43 1450.39 1007.24 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1420.53 1466.95 Q1423.89 1467.66 1425.77 1469.93 Q1427.66 1472.2 1427.66 1475.53 Q1427.66 1480.65 1424.15 1483.45 Q1420.63 1486.25 1414.15 1486.25 Q1411.97 1486.25 1409.66 1485.81 Q1407.36 1485.39 1404.91 1484.54 L1404.91 1480.02 Q1406.85 1481.16 1409.17 1481.74 Q1411.48 1482.32 1414.01 1482.32 Q1418.41 1482.32 1420.7 1480.58 Q1423.01 1478.84 1423.01 1475.53 Q1423.01 1472.48 1420.86 1470.77 Q1418.73 1469.03 1414.91 1469.03 L1410.88 1469.03 L1410.88 1465.19 L1415.09 1465.19 Q1418.54 1465.19 1420.37 1463.82 Q1422.2 1462.43 1422.2 1459.84 Q1422.2 1457.18 1420.3 1455.77 Q1418.43 1454.33 1414.91 1454.33 Q1412.99 1454.33 1410.79 1454.75 Q1408.59 1455.16 1405.95 1456.04 L1405.95 1451.88 Q1408.61 1451.14 1410.93 1450.77 Q1413.27 1450.39 1415.33 1450.39 Q1420.65 1450.39 1423.75 1452.83 Q1426.85 1455.23 1426.85 1459.35 Q1426.85 1462.22 1425.21 1464.21 Q1423.57 1466.18 1420.53 1466.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1446.53 1454.1 Q1442.92 1454.1 1441.09 1457.66 Q1439.28 1461.2 1439.28 1468.33 Q1439.28 1475.44 1441.09 1479.01 Q1442.92 1482.55 1446.53 1482.55 Q1450.16 1482.55 1451.97 1479.01 Q1453.8 1475.44 1453.8 1468.33 Q1453.8 1461.2 1451.97 1457.66 Q1450.16 1454.1 1446.53 1454.1 M1446.53 1450.39 Q1452.34 1450.39 1455.4 1455 Q1458.47 1459.58 1458.47 1468.33 Q1458.47 1477.06 1455.4 1481.67 Q1452.34 1486.25 1446.53 1486.25 Q1440.72 1486.25 1437.64 1481.67 Q1434.59 1477.06 1434.59 1468.33 Q1434.59 1459.58 1437.64 1455 Q1440.72 1450.39 1446.53 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1476.69 1454.1 Q1473.08 1454.1 1471.25 1457.66 Q1469.45 1461.2 1469.45 1468.33 Q1469.45 1475.44 1471.25 1479.01 Q1473.08 1482.55 1476.69 1482.55 Q1480.33 1482.55 1482.13 1479.01 Q1483.96 1475.44 1483.96 1468.33 Q1483.96 1461.2 1482.13 1457.66 Q1480.33 1454.1 1476.69 1454.1 M1476.69 1450.39 Q1482.5 1450.39 1485.56 1455 Q1488.64 1459.58 1488.64 1468.33 Q1488.64 1477.06 1485.56 1481.67 Q1482.5 1486.25 1476.69 1486.25 Q1470.88 1486.25 1467.8 1481.67 Q1464.75 1477.06 1464.75 1468.33 Q1464.75 1459.58 1467.8 1455 Q1470.88 1450.39 1476.69 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1889.38 1455.09 L1877.58 1473.54 L1889.38 1473.54 L1889.38 1455.09 M1888.16 1451.02 L1894.03 1451.02 L1894.03 1473.54 L1898.97 1473.54 L1898.97 1477.43 L1894.03 1477.43 L1894.03 1485.58 L1889.38 1485.58 L1889.38 1477.43 L1873.78 1477.43 L1873.78 1472.92 L1888.16 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1916.7 1454.1 Q1913.09 1454.1 1911.26 1457.66 Q1909.45 1461.2 1909.45 1468.33 Q1909.45 1475.44 1911.26 1479.01 Q1913.09 1482.55 1916.7 1482.55 Q1920.33 1482.55 1922.14 1479.01 Q1923.97 1475.44 1923.97 1468.33 Q1923.97 1461.2 1922.14 1457.66 Q1920.33 1454.1 1916.7 1454.1 M1916.7 1450.39 Q1922.51 1450.39 1925.56 1455 Q1928.64 1459.58 1928.64 1468.33 Q1928.64 1477.06 1925.56 1481.67 Q1922.51 1486.25 1916.7 1486.25 Q1910.89 1486.25 1907.81 1481.67 Q1904.75 1477.06 1904.75 1468.33 Q1904.75 1459.58 1907.81 1455 Q1910.89 1450.39 1916.7 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1946.86 1454.1 Q1943.25 1454.1 1941.42 1457.66 Q1939.61 1461.2 1939.61 1468.33 Q1939.61 1475.44 1941.42 1479.01 Q1943.25 1482.55 1946.86 1482.55 Q1950.49 1482.55 1952.3 1479.01 Q1954.13 1475.44 1954.13 1468.33 Q1954.13 1461.2 1952.3 1457.66 Q1950.49 1454.1 1946.86 1454.1 M1946.86 1450.39 Q1952.67 1450.39 1955.72 1455 Q1958.8 1459.58 1958.8 1468.33 Q1958.8 1477.06 1955.72 1481.67 Q1952.67 1486.25 1946.86 1486.25 Q1941.05 1486.25 1937.97 1481.67 Q1934.91 1477.06 1934.91 1468.33 Q1934.91 1459.58 1937.97 1455 Q1941.05 1450.39 1946.86 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1141.44 1539.24 Q1143.64 1535.29 1146.69 1533.41 Q1149.75 1531.54 1153.89 1531.54 Q1159.46 1531.54 1162.48 1535.45 Q1165.5 1539.33 1165.5 1546.53 L1165.5 1568.04 L1159.61 1568.04 L1159.61 1546.72 Q1159.61 1541.59 1157.8 1539.11 Q1155.99 1536.63 1152.26 1536.63 Q1147.71 1536.63 1145.07 1539.65 Q1142.43 1542.68 1142.43 1547.9 L1142.43 1568.04 L1136.54 1568.04 L1136.54 1546.72 Q1136.54 1541.56 1134.72 1539.11 Q1132.91 1536.63 1129.12 1536.63 Q1124.64 1536.63 1121.99 1539.68 Q1119.35 1542.71 1119.35 1547.9 L1119.35 1568.04 L1113.46 1568.04 L1113.46 1532.4 L1119.35 1532.4 L1119.35 1537.93 Q1121.36 1534.66 1124.16 1533.1 Q1126.96 1531.54 1130.81 1531.54 Q1134.69 1531.54 1137.4 1533.51 Q1140.14 1535.48 1141.44 1539.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1198.67 1538.44 L1239.47 1538.44 L1239.47 1543.79 L1198.67 1543.79 L1198.67 1538.44 M1198.67 1551.43 L1239.47 1551.43 L1239.47 1556.84 L1198.67 1556.84 L1198.67 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1302.87 1546.53 L1302.87 1568.04 L1297.02 1568.04 L1297.02 1546.72 Q1297.02 1541.66 1295.05 1539.14 Q1293.07 1536.63 1289.13 1536.63 Q1284.38 1536.63 1281.65 1539.65 Q1278.91 1542.68 1278.91 1547.9 L1278.91 1568.04 L1273.02 1568.04 L1273.02 1532.4 L1278.91 1532.4 L1278.91 1537.93 Q1281.01 1534.72 1283.84 1533.13 Q1286.71 1531.54 1290.43 1531.54 Q1296.57 1531.54 1299.72 1535.36 Q1302.87 1539.14 1302.87 1546.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1336.04 1538.44 L1376.84 1538.44 L1376.84 1543.79 L1336.04 1543.79 L1336.04 1538.44 M1336.04 1551.43 L1376.84 1551.43 L1376.84 1556.84 L1336.04 1556.84 L1336.04 1551.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1410.39 1518.52 L1416.28 1518.52 L1416.28 1547.77 L1433.75 1532.4 L1441.23 1532.4 L1422.33 1549.07 L1442.03 1568.04 L1434.39 1568.04 L1416.28 1550.63 L1416.28 1568.04 L1410.39 1568.04 L1410.39 1518.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,1423.18 202.737,123.472 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,1202.68 221.634,1202.68 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,962.214 221.634,962.214 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,721.747 221.634,721.747 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,481.28 221.634,481.28 "/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="202.737,240.813 221.634,240.813 "/>
<path clip-path="url(#clip410)" d="M145.116 1219.24 L145.116 1214.98 Q146.876 1215.82 148.681 1216.26 Q150.487 1216.7 152.223 1216.7 Q156.853 1216.7 159.283 1213.6 Q161.737 1210.47 162.084 1204.13 Q160.741 1206.12 158.681 1207.18 Q156.621 1208.25 154.121 1208.25 Q148.936 1208.25 145.904 1205.12 Q142.894 1201.98 142.894 1196.54 Q142.894 1191.21 146.042 1187.99 Q149.191 1184.78 154.422 1184.78 Q160.417 1184.78 163.565 1189.38 Q166.737 1193.97 166.737 1202.72 Q166.737 1210.89 162.848 1215.77 Q158.982 1220.63 152.431 1220.63 Q150.672 1220.63 148.866 1220.29 Q147.061 1219.94 145.116 1219.24 M154.422 1204.59 Q157.57 1204.59 159.399 1202.44 Q161.251 1200.29 161.251 1196.54 Q161.251 1192.81 159.399 1190.66 Q157.57 1188.48 154.422 1188.48 Q151.274 1188.48 149.422 1190.66 Q147.593 1192.81 147.593 1196.54 Q147.593 1200.29 149.422 1202.44 Q151.274 1204.59 154.422 1204.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M117.038 975.559 L124.677 975.559 L124.677 949.194 L116.367 950.86 L116.367 946.601 L124.63 944.934 L129.306 944.934 L129.306 975.559 L136.945 975.559 L136.945 979.494 L117.038 979.494 L117.038 975.559 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M150.417 975.559 L166.737 975.559 L166.737 979.494 L144.792 979.494 L144.792 975.559 Q147.454 972.805 152.038 968.175 Q156.644 963.522 157.825 962.18 Q160.07 959.657 160.95 957.92 Q161.852 956.161 161.852 954.471 Q161.852 951.717 159.908 949.981 Q157.987 948.245 154.885 948.245 Q152.686 948.245 150.232 949.008 Q147.802 949.772 145.024 951.323 L145.024 946.601 Q147.848 945.467 150.302 944.888 Q152.755 944.309 154.792 944.309 Q160.163 944.309 163.357 946.995 Q166.552 949.68 166.552 954.17 Q166.552 956.3 165.741 958.221 Q164.954 960.119 162.848 962.712 Q162.269 963.383 159.167 966.601 Q156.065 969.795 150.417 975.559 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M116.436 735.092 L124.075 735.092 L124.075 708.727 L115.765 710.393 L115.765 706.134 L124.029 704.467 L128.705 704.467 L128.705 735.092 L136.343 735.092 L136.343 739.027 L116.436 739.027 L116.436 735.092 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M145.834 704.467 L164.19 704.467 L164.19 708.402 L150.116 708.402 L150.116 716.875 Q151.135 716.527 152.153 716.365 Q153.172 716.18 154.19 716.18 Q159.978 716.18 163.357 719.351 Q166.737 722.523 166.737 727.939 Q166.737 733.518 163.265 736.62 Q159.792 739.699 153.473 739.699 Q151.297 739.699 149.028 739.328 Q146.783 738.958 144.376 738.217 L144.376 733.518 Q146.459 734.652 148.681 735.208 Q150.903 735.763 153.38 735.763 Q157.385 735.763 159.723 733.657 Q162.061 731.55 162.061 727.939 Q162.061 724.328 159.723 722.222 Q157.385 720.115 153.38 720.115 Q151.505 720.115 149.63 720.532 Q147.778 720.949 145.834 721.828 L145.834 704.467 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M115.533 494.625 L123.172 494.625 L123.172 468.259 L114.862 469.926 L114.862 465.667 L123.126 464 L127.802 464 L127.802 494.625 L135.441 494.625 L135.441 498.56 L115.533 498.56 L115.533 494.625 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M154.885 482.148 Q151.552 482.148 149.63 483.931 Q147.732 485.713 147.732 488.838 Q147.732 491.963 149.63 493.745 Q151.552 495.528 154.885 495.528 Q158.218 495.528 160.14 493.745 Q162.061 491.94 162.061 488.838 Q162.061 485.713 160.14 483.931 Q158.241 482.148 154.885 482.148 M150.209 480.158 Q147.2 479.417 145.51 477.357 Q143.843 475.296 143.843 472.334 Q143.843 468.19 146.783 465.783 Q149.746 463.375 154.885 463.375 Q160.047 463.375 162.987 465.783 Q165.927 468.19 165.927 472.334 Q165.927 475.296 164.237 477.357 Q162.57 479.417 159.584 480.158 Q162.964 480.945 164.839 483.236 Q166.737 485.528 166.737 488.838 Q166.737 493.861 163.658 496.546 Q160.603 499.232 154.885 499.232 Q149.167 499.232 146.089 496.546 Q143.033 493.861 143.033 488.838 Q143.033 485.528 144.931 483.236 Q146.829 480.945 150.209 480.158 M148.496 472.773 Q148.496 475.459 150.163 476.963 Q151.853 478.468 154.885 478.468 Q157.894 478.468 159.584 476.963 Q161.297 475.459 161.297 472.773 Q161.297 470.088 159.584 468.584 Q157.894 467.079 154.885 467.079 Q151.853 467.079 150.163 468.584 Q148.496 470.088 148.496 472.773 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M119.885 254.158 L136.204 254.158 L136.204 258.093 L114.26 258.093 L114.26 254.158 Q116.922 251.403 121.505 246.774 Q126.112 242.121 127.292 240.778 Q129.538 238.255 130.417 236.519 Q131.32 234.76 131.32 233.07 Q131.32 230.316 129.376 228.579 Q127.455 226.843 124.353 226.843 Q122.154 226.843 119.7 227.607 Q117.269 228.371 114.492 229.922 L114.492 225.2 Q117.316 224.066 119.769 223.487 Q122.223 222.908 124.26 222.908 Q129.63 222.908 132.825 225.593 Q136.019 228.279 136.019 232.769 Q136.019 234.899 135.209 236.82 Q134.422 238.718 132.316 241.311 Q131.737 241.982 128.635 245.2 Q125.533 248.394 119.885 254.158 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M146.829 254.158 L154.468 254.158 L154.468 227.792 L146.158 229.459 L146.158 225.2 L154.422 223.533 L159.098 223.533 L159.098 254.158 L166.737 254.158 L166.737 258.093 L146.829 258.093 L146.829 254.158 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M57.2247 888.927 L44.4614 888.927 L44.4614 899.431 L39.1779 899.431 L39.1779 882.562 L59.58 882.562 Q62.2218 886.285 63.5904 890.773 Q64.9272 895.261 64.9272 900.354 Q64.9272 911.494 58.4342 917.796 Q51.9093 924.066 40.2919 924.066 Q28.6427 924.066 22.1496 917.796 Q15.6248 911.494 15.6248 900.354 Q15.6248 895.707 16.7706 891.537 Q17.9164 887.336 20.1444 883.803 L26.9876 883.803 Q23.9639 887.368 22.4361 891.378 Q20.9083 895.388 20.9083 899.813 Q20.9083 908.534 25.7781 912.926 Q30.6479 917.286 40.2919 917.286 Q49.9041 917.286 54.7739 912.926 Q59.6436 908.534 59.6436 899.813 Q59.6436 896.407 59.0707 893.733 Q58.466 891.06 57.2247 888.927 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M16.4842 870.817 L16.4842 843.508 L21.895 843.508 L21.895 864.387 L35.8996 864.387 L35.8996 845.545 L41.3104 845.545 L41.3104 864.387 L64.0042 864.387 L64.0042 870.817 L16.4842 870.817 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M16.4842 833.323 L16.4842 826.893 L58.5933 826.893 L58.5933 803.754 L64.0042 803.754 L64.0042 833.323 L16.4842 833.323 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M20.8447 780.042 Q20.8447 787.044 26.0645 791.182 Q31.2844 795.288 40.2919 795.288 Q49.2675 795.288 54.4874 791.182 Q59.7073 787.044 59.7073 780.042 Q59.7073 773.04 54.4874 768.965 Q49.2675 764.86 40.2919 764.86 Q31.2844 764.86 26.0645 768.965 Q20.8447 773.04 20.8447 780.042 M15.6248 780.042 Q15.6248 770.048 22.3406 764.064 Q29.0246 758.08 40.2919 758.08 Q51.5274 758.08 58.2432 764.064 Q64.9272 770.048 64.9272 780.042 Q64.9272 790.068 58.2432 796.083 Q51.5592 802.067 40.2919 802.067 Q29.0246 802.067 22.3406 796.083 Q15.6248 790.068 15.6248 780.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M21.7677 741.593 L39.6235 741.593 L39.6235 733.508 Q39.6235 729.021 37.3 726.57 Q34.9765 724.119 30.6797 724.119 Q26.4147 724.119 24.0912 726.57 Q21.7677 729.021 21.7677 733.508 L21.7677 741.593 M16.4842 748.022 L16.4842 733.508 Q16.4842 725.52 20.1126 721.445 Q23.7092 717.34 30.6797 717.34 Q37.7138 717.34 41.3104 721.445 Q44.907 725.52 44.907 733.508 L44.907 741.593 L64.0042 741.593 L64.0042 748.022 L16.4842 748.022 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M29.4065 687.389 L34.9447 687.389 Q33.6716 689.872 33.035 692.545 Q32.3984 695.219 32.3984 698.083 Q32.3984 702.444 33.7352 704.64 Q35.072 706.804 37.7456 706.804 Q39.7826 706.804 40.9603 705.245 Q42.1061 703.685 43.1565 698.975 L43.6021 696.969 Q44.9389 690.731 47.3897 688.121 Q49.8086 685.479 54.1691 685.479 Q59.1344 685.479 62.0308 689.426 Q64.9272 693.341 64.9272 700.216 Q64.9272 703.08 64.3543 706.2 Q63.8132 709.287 62.6992 712.724 L56.6518 712.724 Q58.3387 709.478 59.198 706.327 Q60.0256 703.176 60.0256 700.089 Q60.0256 695.951 58.6251 693.723 Q57.1929 691.495 54.6147 691.495 Q52.2276 691.495 50.9545 693.118 Q49.6813 694.71 48.5037 700.152 L48.0262 702.189 Q46.8804 707.632 44.5251 710.051 Q42.138 712.47 38.0002 712.47 Q32.9713 712.47 30.2341 708.905 Q27.4968 705.34 27.4968 698.784 Q27.4968 695.537 27.9743 692.672 Q28.4517 689.808 29.4065 687.389 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M16.4842 665.746 L16.4842 660.335 L70.0516 676.886 L70.0516 682.296 L16.4842 665.746 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M18.0438 625.451 L24.314 625.451 Q22.5634 629.111 21.704 632.357 Q20.8447 635.604 20.8447 638.628 Q20.8447 643.879 22.8817 646.744 Q24.9187 649.577 28.6745 649.577 Q31.8255 649.577 33.4488 647.699 Q35.0402 645.789 36.0269 640.506 L36.8226 636.622 Q38.1912 629.429 41.6605 626.024 Q45.098 622.586 50.8908 622.586 Q57.7976 622.586 61.3624 627.233 Q64.9272 631.848 64.9272 640.792 Q64.9272 644.166 64.1633 647.985 Q63.3994 651.773 61.9035 655.847 L55.2831 655.847 Q57.4793 651.932 58.5933 648.176 Q59.7073 644.42 59.7073 640.792 Q59.7073 635.286 57.543 632.294 Q55.3786 629.302 51.3682 629.302 Q47.8671 629.302 45.8937 631.466 Q43.9204 633.599 42.9337 638.5 L42.1698 642.415 Q40.7375 649.608 37.682 652.823 Q34.6264 656.038 29.1837 656.038 Q22.8817 656.038 19.2532 651.614 Q15.6248 647.158 15.6248 639.36 Q15.6248 636.018 16.2295 632.548 Q16.8343 629.079 18.0438 625.451 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M897.326 12.096 L932.083 12.096 L932.083 18.9825 L905.509 18.9825 L905.509 36.8065 L929.49 36.8065 L929.49 43.6931 L905.509 43.6931 L905.509 72.576 L897.326 72.576 L897.326 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M944.721 9.54393 L952.175 9.54393 L952.175 72.576 L944.721 72.576 L944.721 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M985.352 32.4315 Q979.357 32.4315 975.873 37.1306 Q972.389 41.7891 972.389 49.9314 Q972.389 58.0738 975.832 62.7728 Q979.316 67.4314 985.352 67.4314 Q991.307 67.4314 994.791 62.7323 Q998.274 58.0333 998.274 49.9314 Q998.274 41.8701 994.791 37.1711 Q991.307 32.4315 985.352 32.4315 M985.352 26.1121 Q995.074 26.1121 1000.62 32.4315 Q1006.17 38.7509 1006.17 49.9314 Q1006.17 61.0714 1000.62 67.4314 Q995.074 73.7508 985.352 73.7508 Q975.589 73.7508 970.04 67.4314 Q964.53 61.0714 964.53 49.9314 Q964.53 38.7509 970.04 32.4315 Q975.589 26.1121 985.352 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1039.15 49.7694 Q1030.11 49.7694 1026.63 51.8354 Q1023.15 53.9013 1023.15 58.8839 Q1023.15 62.8538 1025.74 65.2034 Q1028.37 67.5124 1032.87 67.5124 Q1039.07 67.5124 1042.79 63.1374 Q1046.56 58.7219 1046.56 51.4303 L1046.56 49.7694 L1039.15 49.7694 M1054.01 46.6907 L1054.01 72.576 L1046.56 72.576 L1046.56 65.6895 Q1044.01 69.8214 1040.2 71.8063 Q1036.39 73.7508 1030.88 73.7508 Q1023.92 73.7508 1019.78 69.8619 Q1015.69 65.9325 1015.69 59.3701 Q1015.69 51.7138 1020.8 47.825 Q1025.94 43.9361 1036.11 43.9361 L1046.56 43.9361 L1046.56 43.2069 Q1046.56 38.0623 1043.16 35.2672 Q1039.8 32.4315 1033.68 32.4315 Q1029.79 32.4315 1026.1 33.3632 Q1022.42 34.295 1019.02 36.1584 L1019.02 29.2718 Q1023.11 27.692 1026.95 26.9223 Q1030.8 26.1121 1034.45 26.1121 Q1044.29 26.1121 1049.15 31.2163 Q1054.01 36.3204 1054.01 46.6907 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1076.74 14.324 L1076.74 27.2059 L1092.09 27.2059 L1092.09 32.9987 L1076.74 32.9987 L1076.74 57.6282 Q1076.74 63.1779 1078.24 64.7578 Q1079.78 66.3376 1084.44 66.3376 L1092.09 66.3376 L1092.09 72.576 L1084.44 72.576 Q1075.81 72.576 1072.53 69.3758 Q1069.25 66.1351 1069.25 57.6282 L1069.25 32.9987 L1063.78 32.9987 L1063.78 27.2059 L1069.25 27.2059 L1069.25 14.324 L1076.74 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1127.74 39.9662 Q1133.62 41.222 1136.9 45.1919 Q1140.22 49.1618 1140.22 54.9951 Q1140.22 63.9476 1134.06 68.8492 Q1127.9 73.7508 1116.56 73.7508 Q1112.75 73.7508 1108.7 72.9811 Q1104.69 72.2519 1100.4 70.7531 L1100.4 62.8538 Q1103.8 64.8388 1107.85 65.8515 Q1111.9 66.8642 1116.32 66.8642 Q1124.01 66.8642 1128.02 63.826 Q1132.08 60.7879 1132.08 54.9951 Q1132.08 49.6479 1128.31 46.6502 Q1124.58 43.612 1117.9 43.612 L1110.85 43.612 L1110.85 36.8875 L1118.22 36.8875 Q1124.26 36.8875 1127.46 34.4975 Q1130.66 32.067 1130.66 27.5299 Q1130.66 22.8714 1127.34 20.4004 Q1124.06 17.8888 1117.9 17.8888 Q1114.54 17.8888 1110.69 18.618 Q1106.84 19.3471 1102.22 20.8865 L1102.22 13.5948 Q1106.88 12.2985 1110.93 11.6504 Q1115.02 11.0023 1118.63 11.0023 Q1127.94 11.0023 1133.37 15.2557 Q1138.8 19.4686 1138.8 26.6793 Q1138.8 31.7024 1135.92 35.1862 Q1133.05 38.6294 1127.74 39.9662 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1162.78 65.6895 L1191.34 65.6895 L1191.34 72.576 L1152.94 72.576 L1152.94 65.6895 Q1157.6 60.8689 1165.62 52.7671 Q1173.68 44.6248 1175.74 42.2752 Q1179.67 37.8598 1181.21 34.8216 Q1182.79 31.7429 1182.79 28.7857 Q1182.79 23.9651 1179.39 20.927 Q1176.03 17.8888 1170.6 17.8888 Q1166.75 17.8888 1162.46 19.2256 Q1158.2 20.5624 1153.34 23.2765 L1153.34 15.0127 Q1158.29 13.0277 1162.58 12.015 Q1166.87 11.0023 1170.44 11.0023 Q1179.84 11.0023 1185.43 15.7013 Q1191.02 20.4004 1191.02 28.2591 Q1191.02 31.9859 1189.6 35.3482 Q1188.22 38.6699 1184.54 43.2069 Q1183.52 44.3817 1178.09 50.0125 Q1172.67 55.6027 1162.78 65.6895 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1249.75 72.576 L1226.66 12.096 L1235.21 12.096 L1254.37 63.0159 L1273.57 12.096 L1282.08 12.096 L1259.03 72.576 L1249.75 72.576 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1319.51 28.5427 L1319.51 35.5912 Q1316.35 33.9709 1312.95 33.1607 Q1309.55 32.3505 1305.9 32.3505 Q1300.35 32.3505 1297.56 34.0519 Q1294.8 35.7533 1294.8 39.156 Q1294.8 41.7486 1296.79 43.2475 Q1298.77 44.7058 1304.77 46.0426 L1307.32 46.6097 Q1315.26 48.3111 1318.58 51.4303 Q1321.94 54.509 1321.94 60.0587 Q1321.94 66.3781 1316.92 70.0644 Q1311.94 73.7508 1303.19 73.7508 Q1299.54 73.7508 1295.57 73.0216 Q1291.64 72.3329 1287.27 70.9151 L1287.27 63.2184 Q1291.4 65.3654 1295.41 66.4591 Q1299.42 67.5124 1303.35 67.5124 Q1308.61 67.5124 1311.45 65.73 Q1314.29 63.9071 1314.29 60.6258 Q1314.29 57.5877 1312.22 55.9673 Q1310.19 54.3469 1303.27 52.8481 L1300.67 52.2405 Q1293.75 50.7821 1290.67 47.7845 Q1287.59 44.7463 1287.59 39.4801 Q1287.59 33.0797 1292.13 29.5959 Q1296.66 26.1121 1305.01 26.1121 Q1309.14 26.1121 1312.79 26.7198 Q1316.43 27.3274 1319.51 28.5427 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1360.51 12.096 L1395.26 12.096 L1395.26 18.9825 L1368.69 18.9825 L1368.69 36.8065 L1392.67 36.8065 L1392.67 43.6931 L1368.69 43.6931 L1368.69 72.576 L1360.51 72.576 L1360.51 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1407.9 9.54393 L1415.36 9.54393 L1415.36 72.576 L1407.9 72.576 L1407.9 9.54393 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1448.53 32.4315 Q1442.54 32.4315 1439.05 37.1306 Q1435.57 41.7891 1435.57 49.9314 Q1435.57 58.0738 1439.01 62.7728 Q1442.5 67.4314 1448.53 67.4314 Q1454.49 67.4314 1457.97 62.7323 Q1461.45 58.0333 1461.45 49.9314 Q1461.45 41.8701 1457.97 37.1711 Q1454.49 32.4315 1448.53 32.4315 M1448.53 26.1121 Q1458.25 26.1121 1463.8 32.4315 Q1469.35 38.7509 1469.35 49.9314 Q1469.35 61.0714 1463.8 67.4314 Q1458.25 73.7508 1448.53 73.7508 Q1438.77 73.7508 1433.22 67.4314 Q1427.71 61.0714 1427.71 49.9314 Q1427.71 38.7509 1433.22 32.4315 Q1438.77 26.1121 1448.53 26.1121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1502.33 49.7694 Q1493.29 49.7694 1489.81 51.8354 Q1486.33 53.9013 1486.33 58.8839 Q1486.33 62.8538 1488.92 65.2034 Q1491.55 67.5124 1496.05 67.5124 Q1502.25 67.5124 1505.97 63.1374 Q1509.74 58.7219 1509.74 51.4303 L1509.74 49.7694 L1502.33 49.7694 M1517.2 46.6907 L1517.2 72.576 L1509.74 72.576 L1509.74 65.6895 Q1507.19 69.8214 1503.38 71.8063 Q1499.57 73.7508 1494.06 73.7508 Q1487.1 73.7508 1482.97 69.8619 Q1478.87 65.9325 1478.87 59.3701 Q1478.87 51.7138 1483.98 47.825 Q1489.12 43.9361 1499.29 43.9361 L1509.74 43.9361 L1509.74 43.2069 Q1509.74 38.0623 1506.34 35.2672 Q1502.98 32.4315 1496.86 32.4315 Q1492.97 32.4315 1489.28 33.3632 Q1485.6 34.295 1482.2 36.1584 L1482.2 29.2718 Q1486.29 27.692 1490.14 26.9223 Q1493.98 26.1121 1497.63 26.1121 Q1507.47 26.1121 1512.33 31.2163 Q1517.2 36.3204 1517.2 46.6907 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1539.92 14.324 L1539.92 27.2059 L1555.27 27.2059 L1555.27 32.9987 L1539.92 32.9987 L1539.92 57.6282 Q1539.92 63.1779 1541.42 64.7578 Q1542.96 66.3376 1547.62 66.3376 L1555.27 66.3376 L1555.27 72.576 L1547.62 72.576 Q1538.99 72.576 1535.71 69.3758 Q1532.43 66.1351 1532.43 57.6282 L1532.43 32.9987 L1526.96 32.9987 L1526.96 27.2059 L1532.43 27.2059 L1532.43 14.324 L1539.92 14.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1584.64 39.075 Q1579.13 39.075 1575.89 42.8424 Q1572.69 46.6097 1572.69 53.1722 Q1572.69 59.6941 1575.89 63.502 Q1579.13 67.2693 1584.64 67.2693 Q1590.15 67.2693 1593.35 63.502 Q1596.59 59.6941 1596.59 53.1722 Q1596.59 46.6097 1593.35 42.8424 Q1590.15 39.075 1584.64 39.075 M1600.89 13.4328 L1600.89 20.8865 Q1597.81 19.4281 1594.65 18.6585 Q1591.53 17.8888 1588.45 17.8888 Q1580.35 17.8888 1576.05 23.3575 Q1571.8 28.8262 1571.19 39.8852 Q1573.58 36.3609 1577.19 34.4975 Q1580.79 32.5936 1585.13 32.5936 Q1594.24 32.5936 1599.51 38.1433 Q1604.82 43.6525 1604.82 53.1722 Q1604.82 62.4892 1599.31 68.12 Q1593.8 73.7508 1584.64 73.7508 Q1574.15 73.7508 1568.6 65.73 Q1563.05 57.6687 1563.05 42.3968 Q1563.05 28.0566 1569.86 19.5497 Q1576.66 11.0023 1588.13 11.0023 Q1591.21 11.0023 1594.32 11.6099 Q1597.48 12.2175 1600.89 13.4328 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1641.4 19.2256 L1620.74 51.5113 L1641.4 51.5113 L1641.4 19.2256 M1639.25 12.096 L1649.54 12.096 L1649.54 51.5113 L1658.17 51.5113 L1658.17 58.3168 L1649.54 58.3168 L1649.54 72.576 L1641.4 72.576 L1641.4 58.3168 L1614.09 58.3168 L1614.09 50.4176 L1639.25 12.096 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip412)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="263.586,1006.14 488.955,503.292 714.324,362.608 939.693,160.256 1165.06,186.481 1390.43,546.724 1615.8,948.176 1841.17,922.769 2066.54,884.768 2291.91,702.617 "/>
<polyline clip-path="url(#clip412)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="263.586,1253.92 488.955,1047.55 714.324,981.609 939.693,1352.21 1165.06,1386.4 1390.43,1339.43 1615.8,1308.24 1841.17,1310.11 2066.54,1309.88 2291.91,1309.2 "/>
<path clip-path="url(#clip410)" d="M1555.58 322.316 L2281.09 322.316 L2281.09 166.796 L1555.58 166.796  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip410)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1555.58,322.316 2281.09,322.316 2281.09,166.796 1555.58,166.796 1555.58,322.316 "/>
<polyline clip-path="url(#clip410)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="1579.47,218.636 1722.8,218.636 "/>
<path clip-path="url(#clip410)" d="M1767.04 214.967 Q1768.64 212.096 1770.86 210.731 Q1773.08 209.365 1776.09 209.365 Q1780.14 209.365 1782.34 212.212 Q1784.54 215.036 1784.54 220.268 L1784.54 235.916 L1780.26 235.916 L1780.26 220.407 Q1780.26 216.68 1778.94 214.874 Q1777.62 213.069 1774.91 213.069 Q1771.6 213.069 1769.68 215.268 Q1767.76 217.467 1767.76 221.263 L1767.76 235.916 L1763.48 235.916 L1763.48 220.407 Q1763.48 216.657 1762.16 214.874 Q1760.84 213.069 1758.08 213.069 Q1754.82 213.069 1752.9 215.291 Q1750.98 217.49 1750.98 221.263 L1750.98 235.916 L1746.69 235.916 L1746.69 209.99 L1750.98 209.99 L1750.98 214.018 Q1752.43 211.633 1754.47 210.499 Q1756.51 209.365 1759.31 209.365 Q1762.13 209.365 1764.1 210.8 Q1766.09 212.235 1767.04 214.967 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1803.82 238.323 Q1802.02 242.953 1800.3 244.365 Q1798.59 245.777 1795.72 245.777 L1792.32 245.777 L1792.32 242.212 L1794.82 242.212 Q1796.58 242.212 1797.55 241.379 Q1798.52 240.545 1799.7 237.443 L1800.47 235.499 L1789.98 209.99 L1794.49 209.99 L1802.6 230.268 L1810.7 209.99 L1815.21 209.99 L1803.82 238.323 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1838.15 222.652 Q1838.15 218.022 1836.23 215.476 Q1834.33 212.93 1830.88 212.93 Q1827.46 212.93 1825.54 215.476 Q1823.64 218.022 1823.64 222.652 Q1823.64 227.258 1825.54 229.805 Q1827.46 232.351 1830.88 232.351 Q1834.33 232.351 1836.23 229.805 Q1838.15 227.258 1838.15 222.652 M1842.41 232.698 Q1842.41 239.318 1839.47 242.536 Q1836.53 245.777 1830.47 245.777 Q1828.22 245.777 1826.23 245.43 Q1824.24 245.105 1822.36 244.411 L1822.36 240.268 Q1824.24 241.286 1826.07 241.772 Q1827.9 242.258 1829.79 242.258 Q1833.98 242.258 1836.07 240.059 Q1838.15 237.883 1838.15 233.462 L1838.15 231.356 Q1836.83 233.647 1834.77 234.781 Q1832.71 235.916 1829.84 235.916 Q1825.07 235.916 1822.16 232.281 Q1819.24 228.647 1819.24 222.652 Q1819.24 216.633 1822.16 212.999 Q1825.07 209.365 1829.84 209.365 Q1832.71 209.365 1834.77 210.499 Q1836.83 211.633 1838.15 213.925 L1838.15 209.99 L1842.41 209.99 L1842.41 232.698 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1873.36 221.888 L1873.36 223.971 L1853.78 223.971 Q1854.05 228.369 1856.41 230.684 Q1858.8 232.976 1863.03 232.976 Q1865.49 232.976 1867.78 232.374 Q1870.1 231.772 1872.36 230.569 L1872.36 234.596 Q1870.07 235.568 1867.66 236.078 Q1865.26 236.587 1862.78 236.587 Q1856.58 236.587 1852.94 232.976 Q1849.33 229.365 1849.33 223.207 Q1849.33 216.842 1852.76 213.115 Q1856.21 209.365 1862.04 209.365 Q1867.27 209.365 1870.3 212.745 Q1873.36 216.101 1873.36 221.888 M1869.1 220.638 Q1869.05 217.143 1867.13 215.059 Q1865.23 212.976 1862.09 212.976 Q1858.52 212.976 1856.37 214.99 Q1854.24 217.004 1853.91 220.661 L1869.1 220.638 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1900.53 214.967 Q1902.13 212.096 1904.35 210.731 Q1906.58 209.365 1909.59 209.365 Q1913.64 209.365 1915.84 212.212 Q1918.03 215.036 1918.03 220.268 L1918.03 235.916 L1913.75 235.916 L1913.75 220.407 Q1913.75 216.68 1912.43 214.874 Q1911.11 213.069 1908.41 213.069 Q1905.09 213.069 1903.17 215.268 Q1901.25 217.467 1901.25 221.263 L1901.25 235.916 L1896.97 235.916 L1896.97 220.407 Q1896.97 216.657 1895.65 214.874 Q1894.33 213.069 1891.58 213.069 Q1888.31 213.069 1886.39 215.291 Q1884.47 217.49 1884.47 221.263 L1884.47 235.916 L1880.19 235.916 L1880.19 209.99 L1884.47 209.99 L1884.47 214.018 Q1885.93 211.633 1887.97 210.499 Q1890 209.365 1892.8 209.365 Q1895.63 209.365 1897.59 210.8 Q1899.59 212.235 1900.53 214.967 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1946.72 214.967 Q1948.31 212.096 1950.53 210.731 Q1952.76 209.365 1955.77 209.365 Q1959.82 209.365 1962.02 212.212 Q1964.21 215.036 1964.21 220.268 L1964.21 235.916 L1959.93 235.916 L1959.93 220.407 Q1959.93 216.68 1958.61 214.874 Q1957.29 213.069 1954.59 213.069 Q1951.28 213.069 1949.35 215.268 Q1947.43 217.467 1947.43 221.263 L1947.43 235.916 L1943.15 235.916 L1943.15 220.407 Q1943.15 216.657 1941.83 214.874 Q1940.51 213.069 1937.76 213.069 Q1934.49 213.069 1932.57 215.291 Q1930.65 217.49 1930.65 221.263 L1930.65 235.916 L1926.37 235.916 L1926.37 209.99 L1930.65 209.99 L1930.65 214.018 Q1932.11 211.633 1934.15 210.499 Q1936.18 209.365 1938.98 209.365 Q1941.81 209.365 1943.78 210.8 Q1945.77 212.235 1946.72 214.967 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1992.41 243.786 L1992.41 247.096 L1967.78 247.096 L1967.78 243.786 L1992.41 243.786 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2000.53 232.027 L2000.53 245.777 L1996.25 245.777 L1996.25 209.99 L2000.53 209.99 L2000.53 213.925 Q2001.88 211.61 2003.91 210.499 Q2005.97 209.365 2008.82 209.365 Q2013.54 209.365 2016.48 213.115 Q2019.45 216.865 2019.45 222.976 Q2019.45 229.087 2016.48 232.837 Q2013.54 236.587 2008.82 236.587 Q2005.97 236.587 2003.91 235.476 Q2001.88 234.342 2000.53 232.027 M2015.02 222.976 Q2015.02 218.277 2013.08 215.615 Q2011.16 212.93 2007.78 212.93 Q2004.4 212.93 2002.46 215.615 Q2000.53 218.277 2000.53 222.976 Q2000.53 227.675 2002.46 230.36 Q2004.4 233.022 2007.78 233.022 Q2011.16 233.022 2013.08 230.36 Q2015.02 227.675 2015.02 222.976 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2026.51 209.99 L2030.77 209.99 L2030.77 236.379 Q2030.77 241.332 2028.87 243.555 Q2026.99 245.777 2022.8 245.777 L2021.18 245.777 L2021.18 242.166 L2022.32 242.166 Q2024.75 242.166 2025.63 241.031 Q2026.51 239.92 2026.51 236.379 L2026.51 209.99 M2026.51 199.897 L2030.77 199.897 L2030.77 205.291 L2026.51 205.291 L2026.51 199.897 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2039.68 209.99 L2043.94 209.99 L2043.94 235.916 L2039.68 235.916 L2039.68 209.99 M2039.68 199.897 L2043.94 199.897 L2043.94 205.291 L2039.68 205.291 L2039.68 199.897 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2055.53 230.036 L2060.23 230.036 L2060.23 235.916 L2055.53 235.916 L2055.53 230.036 M2055.53 201.356 L2060.23 201.356 L2060.23 216.518 L2059.77 224.782 L2056.02 224.782 L2055.53 216.518 L2055.53 201.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2087.11 201.356 L2106.97 201.356 L2106.97 205.291 L2091.78 205.291 L2091.78 215.476 L2105.49 215.476 L2105.49 219.411 L2091.78 219.411 L2091.78 235.916 L2087.11 235.916 L2087.11 201.356 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2114.19 199.897 L2118.45 199.897 L2118.45 235.916 L2114.19 235.916 L2114.19 199.897 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2137.41 212.976 Q2133.98 212.976 2131.99 215.661 Q2130 218.323 2130 222.976 Q2130 227.629 2131.97 230.314 Q2133.96 232.976 2137.41 232.976 Q2140.81 232.976 2142.8 230.291 Q2144.79 227.606 2144.79 222.976 Q2144.79 218.37 2142.8 215.684 Q2140.81 212.976 2137.41 212.976 M2137.41 209.365 Q2142.96 209.365 2146.14 212.976 Q2149.31 216.587 2149.31 222.976 Q2149.31 229.342 2146.14 232.976 Q2142.96 236.587 2137.41 236.587 Q2131.83 236.587 2128.66 232.976 Q2125.51 229.342 2125.51 222.976 Q2125.51 216.587 2128.66 212.976 Q2131.83 209.365 2137.41 209.365 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2168.15 222.883 Q2162.99 222.883 2161 224.064 Q2159.01 225.244 2159.01 228.092 Q2159.01 230.36 2160.49 231.703 Q2161.99 233.022 2164.56 233.022 Q2168.1 233.022 2170.23 230.522 Q2172.39 227.999 2172.39 223.832 L2172.39 222.883 L2168.15 222.883 M2176.64 221.124 L2176.64 235.916 L2172.39 235.916 L2172.39 231.981 Q2170.93 234.342 2168.75 235.476 Q2166.57 236.587 2163.43 236.587 Q2159.45 236.587 2157.08 234.365 Q2154.75 232.119 2154.75 228.369 Q2154.75 223.994 2157.66 221.772 Q2160.6 219.55 2166.41 219.55 L2172.39 219.55 L2172.39 219.133 Q2172.39 216.194 2170.44 214.596 Q2168.52 212.976 2165.02 212.976 Q2162.8 212.976 2160.7 213.508 Q2158.59 214.041 2156.64 215.106 L2156.64 211.17 Q2158.98 210.268 2161.18 209.828 Q2163.38 209.365 2165.46 209.365 Q2171.09 209.365 2173.87 212.282 Q2176.64 215.198 2176.64 221.124 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2189.63 202.629 L2189.63 209.99 L2198.4 209.99 L2198.4 213.3 L2189.63 213.3 L2189.63 227.374 Q2189.63 230.545 2190.49 231.448 Q2191.37 232.351 2194.03 232.351 L2198.4 232.351 L2198.4 235.916 L2194.03 235.916 Q2189.1 235.916 2187.22 234.087 Q2185.35 232.235 2185.35 227.374 L2185.35 213.3 L2182.22 213.3 L2182.22 209.99 L2185.35 209.99 L2185.35 202.629 L2189.63 202.629 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2218.77 217.282 Q2222.13 217.999 2224.01 220.268 Q2225.9 222.536 2225.9 225.869 Q2225.9 230.985 2222.38 233.786 Q2218.87 236.587 2212.38 236.587 Q2210.21 236.587 2207.89 236.147 Q2205.6 235.731 2203.15 234.874 L2203.15 230.36 Q2205.09 231.494 2207.41 232.073 Q2209.72 232.652 2212.25 232.652 Q2216.64 232.652 2218.94 230.916 Q2221.25 229.18 2221.25 225.869 Q2221.25 222.814 2219.1 221.101 Q2216.97 219.365 2213.15 219.365 L2209.12 219.365 L2209.12 215.522 L2213.33 215.522 Q2216.78 215.522 2218.61 214.157 Q2220.44 212.768 2220.44 210.175 Q2220.44 207.513 2218.54 206.101 Q2216.67 204.666 2213.15 204.666 Q2211.23 204.666 2209.03 205.083 Q2206.83 205.499 2204.19 206.379 L2204.19 202.212 Q2206.85 201.471 2209.17 201.101 Q2211.51 200.731 2213.57 200.731 Q2218.89 200.731 2221.99 203.161 Q2225.09 205.569 2225.09 209.689 Q2225.09 212.559 2223.45 214.55 Q2221.81 216.518 2218.77 217.282 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2238.8 231.981 L2255.12 231.981 L2255.12 235.916 L2233.17 235.916 L2233.17 231.981 Q2235.83 229.226 2240.42 224.596 Q2245.02 219.944 2246.2 218.601 Q2248.45 216.078 2249.33 214.342 Q2250.23 212.583 2250.23 210.893 Q2250.23 208.138 2248.29 206.402 Q2246.37 204.666 2243.26 204.666 Q2241.07 204.666 2238.61 205.43 Q2236.18 206.194 2233.4 207.745 L2233.4 203.022 Q2236.23 201.888 2238.68 201.309 Q2241.13 200.731 2243.17 200.731 Q2248.54 200.731 2251.74 203.416 Q2254.93 206.101 2254.93 210.592 Q2254.93 212.721 2254.12 214.643 Q2253.33 216.541 2251.23 219.133 Q2250.65 219.805 2247.55 223.022 Q2244.44 226.217 2238.8 231.981 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip410)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:16; stroke-opacity:1; fill:none" points="1579.47,270.476 1722.8,270.476 "/>
<path clip-path="url(#clip410)" d="M1767.04 266.807 Q1768.64 263.936 1770.86 262.571 Q1773.08 261.205 1776.09 261.205 Q1780.14 261.205 1782.34 264.052 Q1784.54 266.876 1784.54 272.108 L1784.54 287.756 L1780.26 287.756 L1780.26 272.247 Q1780.26 268.52 1778.94 266.714 Q1777.62 264.909 1774.91 264.909 Q1771.6 264.909 1769.68 267.108 Q1767.76 269.307 1767.76 273.103 L1767.76 287.756 L1763.48 287.756 L1763.48 272.247 Q1763.48 268.497 1762.16 266.714 Q1760.84 264.909 1758.08 264.909 Q1754.82 264.909 1752.9 267.131 Q1750.98 269.33 1750.98 273.103 L1750.98 287.756 L1746.69 287.756 L1746.69 261.83 L1750.98 261.83 L1750.98 265.858 Q1752.43 263.473 1754.47 262.339 Q1756.51 261.205 1759.31 261.205 Q1762.13 261.205 1764.1 262.64 Q1766.09 264.075 1767.04 266.807 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1803.82 290.163 Q1802.02 294.793 1800.3 296.205 Q1798.59 297.617 1795.72 297.617 L1792.32 297.617 L1792.32 294.052 L1794.82 294.052 Q1796.58 294.052 1797.55 293.219 Q1798.52 292.385 1799.7 289.283 L1800.47 287.339 L1789.98 261.83 L1794.49 261.83 L1802.6 282.108 L1810.7 261.83 L1815.21 261.83 L1803.82 290.163 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1838.15 274.492 Q1838.15 269.862 1836.23 267.316 Q1834.33 264.77 1830.88 264.77 Q1827.46 264.77 1825.54 267.316 Q1823.64 269.862 1823.64 274.492 Q1823.64 279.098 1825.54 281.645 Q1827.46 284.191 1830.88 284.191 Q1834.33 284.191 1836.23 281.645 Q1838.15 279.098 1838.15 274.492 M1842.41 284.538 Q1842.41 291.158 1839.47 294.376 Q1836.53 297.617 1830.47 297.617 Q1828.22 297.617 1826.23 297.27 Q1824.24 296.945 1822.36 296.251 L1822.36 292.108 Q1824.24 293.126 1826.07 293.612 Q1827.9 294.098 1829.79 294.098 Q1833.98 294.098 1836.07 291.899 Q1838.15 289.723 1838.15 285.302 L1838.15 283.196 Q1836.83 285.487 1834.77 286.621 Q1832.71 287.756 1829.84 287.756 Q1825.07 287.756 1822.16 284.121 Q1819.24 280.487 1819.24 274.492 Q1819.24 268.473 1822.16 264.839 Q1825.07 261.205 1829.84 261.205 Q1832.71 261.205 1834.77 262.339 Q1836.83 263.473 1838.15 265.765 L1838.15 261.83 L1842.41 261.83 L1842.41 284.538 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1873.36 273.728 L1873.36 275.811 L1853.78 275.811 Q1854.05 280.209 1856.41 282.524 Q1858.8 284.816 1863.03 284.816 Q1865.49 284.816 1867.78 284.214 Q1870.1 283.612 1872.36 282.409 L1872.36 286.436 Q1870.07 287.408 1867.66 287.918 Q1865.26 288.427 1862.78 288.427 Q1856.58 288.427 1852.94 284.816 Q1849.33 281.205 1849.33 275.047 Q1849.33 268.682 1852.76 264.955 Q1856.21 261.205 1862.04 261.205 Q1867.27 261.205 1870.3 264.585 Q1873.36 267.941 1873.36 273.728 M1869.1 272.478 Q1869.05 268.983 1867.13 266.899 Q1865.23 264.816 1862.09 264.816 Q1858.52 264.816 1856.37 266.83 Q1854.24 268.844 1853.91 272.501 L1869.1 272.478 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1900.53 266.807 Q1902.13 263.936 1904.35 262.571 Q1906.58 261.205 1909.59 261.205 Q1913.64 261.205 1915.84 264.052 Q1918.03 266.876 1918.03 272.108 L1918.03 287.756 L1913.75 287.756 L1913.75 272.247 Q1913.75 268.52 1912.43 266.714 Q1911.11 264.909 1908.41 264.909 Q1905.09 264.909 1903.17 267.108 Q1901.25 269.307 1901.25 273.103 L1901.25 287.756 L1896.97 287.756 L1896.97 272.247 Q1896.97 268.497 1895.65 266.714 Q1894.33 264.909 1891.58 264.909 Q1888.31 264.909 1886.39 267.131 Q1884.47 269.33 1884.47 273.103 L1884.47 287.756 L1880.19 287.756 L1880.19 261.83 L1884.47 261.83 L1884.47 265.858 Q1885.93 263.473 1887.97 262.339 Q1890 261.205 1892.8 261.205 Q1895.63 261.205 1897.59 262.64 Q1899.59 264.075 1900.53 266.807 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1946.72 266.807 Q1948.31 263.936 1950.53 262.571 Q1952.76 261.205 1955.77 261.205 Q1959.82 261.205 1962.02 264.052 Q1964.21 266.876 1964.21 272.108 L1964.21 287.756 L1959.93 287.756 L1959.93 272.247 Q1959.93 268.52 1958.61 266.714 Q1957.29 264.909 1954.59 264.909 Q1951.28 264.909 1949.35 267.108 Q1947.43 269.307 1947.43 273.103 L1947.43 287.756 L1943.15 287.756 L1943.15 272.247 Q1943.15 268.497 1941.83 266.714 Q1940.51 264.909 1937.76 264.909 Q1934.49 264.909 1932.57 267.131 Q1930.65 269.33 1930.65 273.103 L1930.65 287.756 L1926.37 287.756 L1926.37 261.83 L1930.65 261.83 L1930.65 265.858 Q1932.11 263.473 1934.15 262.339 Q1936.18 261.205 1938.98 261.205 Q1941.81 261.205 1943.78 262.64 Q1945.77 264.075 1946.72 266.807 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M1992.41 295.626 L1992.41 298.936 L1967.78 298.936 L1967.78 295.626 L1992.41 295.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2000.53 283.867 L2000.53 297.617 L1996.25 297.617 L1996.25 261.83 L2000.53 261.83 L2000.53 265.765 Q2001.88 263.45 2003.91 262.339 Q2005.97 261.205 2008.82 261.205 Q2013.54 261.205 2016.48 264.955 Q2019.45 268.705 2019.45 274.816 Q2019.45 280.927 2016.48 284.677 Q2013.54 288.427 2008.82 288.427 Q2005.97 288.427 2003.91 287.316 Q2001.88 286.182 2000.53 283.867 M2015.02 274.816 Q2015.02 270.117 2013.08 267.455 Q2011.16 264.77 2007.78 264.77 Q2004.4 264.77 2002.46 267.455 Q2000.53 270.117 2000.53 274.816 Q2000.53 279.515 2002.46 282.2 Q2004.4 284.862 2007.78 284.862 Q2011.16 284.862 2013.08 282.2 Q2015.02 279.515 2015.02 274.816 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2026.51 261.83 L2030.77 261.83 L2030.77 288.219 Q2030.77 293.172 2028.87 295.395 Q2026.99 297.617 2022.8 297.617 L2021.18 297.617 L2021.18 294.006 L2022.32 294.006 Q2024.75 294.006 2025.63 292.871 Q2026.51 291.76 2026.51 288.219 L2026.51 261.83 M2026.51 251.737 L2030.77 251.737 L2030.77 257.131 L2026.51 257.131 L2026.51 251.737 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2039.68 261.83 L2043.94 261.83 L2043.94 287.756 L2039.68 287.756 L2039.68 261.83 M2039.68 251.737 L2043.94 251.737 L2043.94 257.131 L2039.68 257.131 L2039.68 251.737 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2055.53 281.876 L2060.23 281.876 L2060.23 287.756 L2055.53 287.756 L2055.53 281.876 M2055.53 253.196 L2060.23 253.196 L2060.23 268.358 L2059.77 276.622 L2056.02 276.622 L2055.53 268.358 L2055.53 253.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2087.11 253.196 L2106.97 253.196 L2106.97 257.131 L2091.78 257.131 L2091.78 267.316 L2105.49 267.316 L2105.49 271.251 L2091.78 271.251 L2091.78 287.756 L2087.11 287.756 L2087.11 253.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2114.19 251.737 L2118.45 251.737 L2118.45 287.756 L2114.19 287.756 L2114.19 251.737 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2137.41 264.816 Q2133.98 264.816 2131.99 267.501 Q2130 270.163 2130 274.816 Q2130 279.469 2131.97 282.154 Q2133.96 284.816 2137.41 284.816 Q2140.81 284.816 2142.8 282.131 Q2144.79 279.446 2144.79 274.816 Q2144.79 270.21 2142.8 267.524 Q2140.81 264.816 2137.41 264.816 M2137.41 261.205 Q2142.96 261.205 2146.14 264.816 Q2149.31 268.427 2149.31 274.816 Q2149.31 281.182 2146.14 284.816 Q2142.96 288.427 2137.41 288.427 Q2131.83 288.427 2128.66 284.816 Q2125.51 281.182 2125.51 274.816 Q2125.51 268.427 2128.66 264.816 Q2131.83 261.205 2137.41 261.205 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2168.15 274.723 Q2162.99 274.723 2161 275.904 Q2159.01 277.084 2159.01 279.932 Q2159.01 282.2 2160.49 283.543 Q2161.99 284.862 2164.56 284.862 Q2168.1 284.862 2170.23 282.362 Q2172.39 279.839 2172.39 275.672 L2172.39 274.723 L2168.15 274.723 M2176.64 272.964 L2176.64 287.756 L2172.39 287.756 L2172.39 283.821 Q2170.93 286.182 2168.75 287.316 Q2166.57 288.427 2163.43 288.427 Q2159.45 288.427 2157.08 286.205 Q2154.75 283.959 2154.75 280.209 Q2154.75 275.834 2157.66 273.612 Q2160.6 271.39 2166.41 271.39 L2172.39 271.39 L2172.39 270.973 Q2172.39 268.034 2170.44 266.436 Q2168.52 264.816 2165.02 264.816 Q2162.8 264.816 2160.7 265.348 Q2158.59 265.881 2156.64 266.946 L2156.64 263.01 Q2158.98 262.108 2161.18 261.668 Q2163.38 261.205 2165.46 261.205 Q2171.09 261.205 2173.87 264.122 Q2176.64 267.038 2176.64 272.964 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2189.63 254.469 L2189.63 261.83 L2198.4 261.83 L2198.4 265.14 L2189.63 265.14 L2189.63 279.214 Q2189.63 282.385 2190.49 283.288 Q2191.37 284.191 2194.03 284.191 L2198.4 284.191 L2198.4 287.756 L2194.03 287.756 Q2189.1 287.756 2187.22 285.927 Q2185.35 284.075 2185.35 279.214 L2185.35 265.14 L2182.22 265.14 L2182.22 261.83 L2185.35 261.83 L2185.35 254.469 L2189.63 254.469 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2215.19 268.612 Q2212.04 268.612 2210.19 270.765 Q2208.36 272.918 2208.36 276.668 Q2208.36 280.395 2210.19 282.571 Q2212.04 284.723 2215.19 284.723 Q2218.33 284.723 2220.16 282.571 Q2222.01 280.395 2222.01 276.668 Q2222.01 272.918 2220.16 270.765 Q2218.33 268.612 2215.19 268.612 M2224.47 253.96 L2224.47 258.219 Q2222.71 257.386 2220.9 256.946 Q2219.12 256.506 2217.36 256.506 Q2212.73 256.506 2210.28 259.631 Q2207.85 262.756 2207.5 269.075 Q2208.87 267.061 2210.93 265.997 Q2212.99 264.909 2215.46 264.909 Q2220.67 264.909 2223.68 268.08 Q2226.71 271.228 2226.71 276.668 Q2226.71 281.992 2223.57 285.209 Q2220.42 288.427 2215.19 288.427 Q2209.19 288.427 2206.02 283.844 Q2202.85 279.237 2202.85 270.51 Q2202.85 262.316 2206.74 257.455 Q2210.63 252.571 2217.18 252.571 Q2218.94 252.571 2220.72 252.918 Q2222.52 253.265 2224.47 253.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip410)" d="M2247.62 257.27 L2235.81 275.719 L2247.62 275.719 L2247.62 257.27 M2246.39 253.196 L2252.27 253.196 L2252.27 275.719 L2257.2 275.719 L2257.2 279.608 L2252.27 279.608 L2252.27 287.756 L2247.62 287.756 L2247.62 279.608 L2232.01 279.608 L2232.01 275.094 L2246.39 253.196 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
</div></div>
</div>
<p>By uncommenting each of the individual <code class="docutils literal notranslate"><span class="pre">my_gemm</span></code> with the different loop orderings in the above code, for <code class="docutils literal notranslate"><span class="pre">Float64</span></code> precision, we find that the best loop ordering for this problem is <code class="docutils literal notranslate"><span class="pre">pji</span></code>. Notice that Julia stores matrices in clumn-major order and data in columns are stored contiguously. The <code class="docutils literal notranslate"><span class="pre">pji</span></code> loop ordering performs a rank-one update (it repeatedly updates all elements of <span class="math notranslate nohighlight">\(C\)</span>) with outer product computed using <code class="docutils literal notranslate"><span class="pre">axpy</span></code> with the column vector <span class="math notranslate nohighlight">\(a_p\)</span>.</p>
<div class="math notranslate nohighlight">
\[
  a_{p} \tilde{b}_{p}^T =
  \begin{bmatrix}
    a_{p} \beta_{1p} &amp; \cdots &amp; a_{p} \beta_{mp}
  \end{bmatrix}
\]</div>
<p>In the code snippet</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">k</span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">n</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">m</span>
<span class="w">         </span><span class="nd">@inbounds</span><span class="w"> </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">]</span>
<span class="w">      </span><span class="k">end</span>
<span class="w">   </span><span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
<p>being <code class="docutils literal notranslate"><span class="pre">i</span></code> the fastest index, each execution of the inner-most loop traverses the <span class="math notranslate nohighlight">\(p\)</span>-th column of <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\( a_{p}\)</span>, multiplies it by the <span class="math notranslate nohighlight">\(\beta_{jp}\)</span> entry of <span class="math notranslate nohighlight">\(B\)</span> (moving down in the column entries at the next iteration of the <code class="docutils literal notranslate"><span class="pre">j</span></code> loop, facilitating cache reuse), and updates columns of <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>The following numbers are the result of the executions on my machine:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>size |      reference      |           mygemm_ijp!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  8.01e-06    27.60  |  1.12e-04     1.97   7.11e-15
  96 |  4.83e-05    36.66  |  9.83e-04     1.80   1.78e-14
 144 |  1.46e-04    40.88  |  3.45e-03     1.73   2.84e-14
 192 |  3.58e-04    39.55  |  8.47e-03     1.67   3.55e-14
 240 |  6.21e-04    44.56  |  1.66e-02     1.67   5.68e-14
 288 |  1.04e-03    45.74  |  2.91e-02     1.64   1.71e-13
 336 |  1.65e-03    45.98  |  4.57e-02     1.66   2.27e-13
 384 |  2.47e-03    45.87  |  1.57e-01     0.72   2.70e-13
 432 |  3.63e-03    44.47  |  9.70e-02     1.66   2.84e-13
 480 |  6.10e-03    36.26  |  1.53e-01     1.45   3.69e-13


size |      reference      |           mygemm_ipj!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  8.06e-06    27.46  |  6.83e-05     3.24   7.11e-15
  96 |  4.79e-05    36.91  |  7.54e-04     2.35   1.78e-14
 144 |  1.45e-04    41.06  |  1.84e-03     3.25   2.84e-14
 192 |  5.21e-04    27.15  |  1.07e-02     1.33   3.55e-14
 240 |  6.73e-04    41.10  |  1.11e-02     2.49   5.68e-14
 288 |  1.04e-03    45.78  |  3.44e-02     1.39   1.71e-13
 336 |  1.64e-03    46.33  |  5.30e-02     1.43   2.27e-13
 384 |  2.44e-03    46.42  |  1.85e-01     0.61   2.70e-13
 432 |  3.58e-03    45.06  |  1.13e-01     1.43   2.84e-13
 480 |  5.58e-03    39.60  |  1.60e-01     1.38   3.69e-13


size |      reference      |           mygemm_pij!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  8.06e-06    27.45  |  6.95e-05     3.18   7.11e-15
  96 |  4.83e-05    36.66  |  6.73e-04     2.63   1.78e-14
 144 |  1.46e-04    40.84  |  1.92e-03     3.10   2.84e-14
 192 |  3.30e-04    42.90  |  1.15e-02     1.24   3.55e-14
 240 |  8.77e-04    31.52  |  1.62e-02     1.71   5.68e-14
 288 |  1.95e-03    24.56  |  3.74e-02     1.28   1.71e-13
 336 |  1.65e-03    45.88  |  5.72e-02     1.33   2.27e-13
 384 |  2.62e-03    43.23  |  1.83e-01     0.62   2.70e-13
 432 |  4.90e-03    32.88  |  1.23e-01     1.31   2.84e-13
 480 |  5.94e-03    37.23  |  1.75e-01     1.26   3.69e-13


size |      reference      |           mygemm_pji!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  8.02e-06    27.58  |  2.07e-05    10.67   7.11e-15
  96 |  4.79e-05    36.91  |  1.35e-04    13.10   1.78e-14
 144 |  1.46e-04    40.96  |  4.31e-04    13.86   2.84e-14
 192 |  3.28e-04    43.12  |  1.21e-03    11.65   3.55e-14
 240 |  1.04e-03    26.66  |  3.47e-03     7.96   5.68e-14
 288 |  1.08e-03    44.19  |  5.37e-03     8.90   1.71e-13
 336 |  1.71e-03    44.50  |  8.59e-03     8.84   2.27e-13
 384 |  2.46e-03    46.06  |  1.28e-02     8.84   2.70e-13
 432 |  3.52e-03    45.80  |  1.82e-02     8.87   2.84e-13
 480 |  4.66e-03    47.48  |  2.52e-02     8.79   3.69e-13


size |      reference      |           mygemm_jpi!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  8.22e-06    26.92  |  6.79e-05     3.26   7.11e-15
  96 |  4.81e-05    36.81  |  5.03e-04     3.51   1.78e-14
 144 |  1.46e-04    40.87  |  1.80e-03     3.31   2.84e-14
 192 |  3.43e-04    41.29  |  4.41e-03     3.21   3.55e-14
 240 |  6.30e-04    43.89  |  8.90e-03     3.11   5.68e-14
 288 |  1.44e-03    33.24  |  1.69e-02     2.83   1.71e-13
 336 |  1.66e-03    45.60  |  2.48e-02     3.06   2.27e-13
 384 |  2.46e-03    46.03  |  3.52e-02     3.22   2.70e-13
 432 |  5.47e-03    29.50  |  4.89e-02     3.30   2.84e-13
 480 |  5.36e-03    41.30  |  6.70e-02     3.30   3.69e-13


size |      reference      |           mygemm_jip!
     |   seconds   GFLOPS  |   seconds   GFLOPS     diff
  48 |  8.03e-06    27.54  |  9.19e-05     2.41   7.11e-15
  96 |  4.81e-05    36.78  |  9.87e-04     1.79   1.78e-14
 144 |  1.46e-04    40.82  |  3.36e-03     1.78   2.84e-14
 192 |  5.79e-04    24.44  |  8.46e-03     1.67   3.55e-14
 240 |  7.41e-04    37.32  |  1.76e-02     1.57   5.68e-14
 288 |  1.06e-03    45.07  |  2.90e-02     1.65   1.71e-13
 336 |  1.65e-03    45.99  |  4.48e-02     1.69   2.27e-13
 384 |  2.43e-03    46.61  |  1.60e-01     0.71   2.70e-13
 432 |  4.82e-03    33.43  |  9.61e-02     1.68   2.84e-13
 480 |  6.59e-03    33.57  |  1.53e-01     1.44   3.69e-13
</pre></div>
</div>
<p>And the following figure compares all of the six loop orderings for square matrices filled with <code class="docutils literal notranslate"><span class="pre">Float64</span></code> numbers:</p>
<p><img alt="My solution for HW2 showing mygemm_pji is the best loop ordering" src="../_images/assignment2_square_F64.png" /></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sdsu-comp605/spring25",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.10"
        },
        kernelOptions: {
            name: "julia-1.10",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.10'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="module4-2_case_study_2_climacore.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">15) Case Study 2: ClimaCore</p>
      </div>
    </a>
    <a class="right-next"
       href="module5-1_reductions_and_scans.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">17) Parallel reductions and scans</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valeria Barra
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>